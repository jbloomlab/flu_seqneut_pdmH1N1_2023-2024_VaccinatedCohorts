<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/favicon.ico" />
    <!-- Preload is necessary because we show these images when we disconnect from the server,
    but at that point we cannot load these images from the server -->
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/gradient-yHQUC_QB.png" as="image" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/noise-60BoTA8O.png" as="image" />
    <!-- Preload the fonts -->
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/Lora-VariableFont_wght-B2ootaw-.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/PTSans-Regular-CxL0S8W7.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/PTSans-Bold-D9fedIX3.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/FiraMono-Regular-BTCkDNvf.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/FiraMono-Medium-DU3aDxX5.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/FiraMono-Bold-CLVRCuM9.ttf" as="font" crossorigin="anonymous" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#000000" />
    <meta name="description" content="a marimo app" />
    <link rel="apple-touch-icon" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/apple-touch-icon.png" />
    <link rel="manifest" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/manifest.json" />

    <script data-marimo="true">
      function __resizeIframe(obj) {
        var scrollbarHeight = 20; // Max between windows, mac, and linux

        function setHeight() {
          // Guard against race condition where iframe isn't ready
          if (!obj.contentWindow?.document?.documentElement) {
            return;
          }
          var element = obj.contentWindow.document.documentElement;
          // If there is no vertical scrollbar, we don't need to resize the iframe
          if (element.scrollHeight === element.clientHeight) {
            return;
          }

          // Create a new height that includes the scrollbar height if it's visible
          var hasHorizontalScrollbar = element.scrollWidth > element.clientWidth;
          var newHeight = element.scrollHeight + (hasHorizontalScrollbar ? scrollbarHeight : 0);

          // Only update the height if it's different from the current height
          if (obj.style.height !== `${newHeight}px`) {
            obj.style.height = `${newHeight}px`;
          }
        }

        // Resize the iframe to the height of the content and bottom scrollbar height
        setHeight();

        // Resize the iframe when the content changes
        const resizeObserver = new ResizeObserver((entries) => {
          setHeight();
        });
        // Only observe if iframe content is ready
        if (obj.contentWindow?.document?.body) {
          resizeObserver.observe(obj.contentWindow.document.body);
        }
      }
    </script>
    <marimo-filename hidden>aggregate_qc_drops.py</marimo-filename>
    <!-- TODO(Trevor): Legacy, required by VS Code plugin. Remove when plugin is updated (see marimo/server/_templates/template.py) -->
    <marimo-version data-version="{{ version }}" hidden></marimo-version>
    <marimo-user-config data-config="{{ user_config }}" hidden></marimo-user-config>
    <marimo-server-token data-token="{{ server_token }}" hidden></marimo-server-token>
    <!-- /TODO -->
    <title>aggregate qc drops</title>
    <script type="module" crossorigin crossorigin="anonymous" src="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/index-vG-gdKWq.js"></script>
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/preload-helper-DImqtvgl.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/chunk-DZLz74EQ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/react-BcIddLXZ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/compiler-runtime-Cr9loedd.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/jsx-runtime-mwDPpfh_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/useEventListener-D1FLsfmf.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/react-dom-D6bRRS5R.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/Combination-DWHMUa0d.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/cn-DEUt_IsG.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/menu-items-Dm8s6sMr.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/hotkeys-ClCtr3_I.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/button-Zjtz1syG.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/dist-1ZdxNBaX.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/createLucideIcon-CaU6_Jtx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/check-Dc7YCRim.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/select-Di-JjADd.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/multi-map-COQ6MvP7.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/chevron-right-BExEgq1M.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/dropdown-menu-ChUikXiI.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/tooltip-CerBk_un.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/_Uint8Array-D5Z9rM2X.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/_getTag-CVRrQL_Q.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/_baseIsEqual-CVFfFJm2.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/jotai-BTnrNcC1.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/invariant-D5a0EE05.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/isArrayLikeObject-DKyJYtr8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/merge-Dvc5opZF.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/zod-U2NFpcFA.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/utils-BpjB6B-Y.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/requests-DD3OWR81.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/once-3GsqimLM.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/toDate-CnvLb18a.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/_baseSlice-BWZ0PeaJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/_arrayMap-DQI2GUNb.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/isSymbol-xTSywenE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/toString-CBnct2wx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/_hasUnicode-3DIK_jNi.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/upperFirst-CBQfDRod.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/capitalize-CBqvgOfA.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/ai-model-dropdown-CCxgO0mJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/badge-CxcKOiwY.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/use-toast-BPMVOfO3.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/constants-CEISdYm1.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/Deferred-Mppm0cvJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/config-e9OVB2bJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/uuid-4lb_EYpq.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/key-BOd4SjWu.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/connection-CsVOmbVi.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/useLifecycle-CxNbfWnk.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/useNonce-CL3DrH5R.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/capabilities-CEL4hxAo.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/createReducer-C6dJ71nW.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/dist-o3-gJN-A.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/dist-DdXBxU_X.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/dist-Dv7WCK3M.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/dist-w3K5vvwl.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/dist-DXPWGCwf.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/dist-BOJjflZo.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/dist-ws1ADWL0.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/dist-BGbJQ9FV.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/dist-dCpey1ug.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/stex-w1KpyykF.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/_baseProperty-c4IQJQis.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/toNumber-CTOPJrpu.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/now-BXqTLlmI.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/debounce-BUM2losY.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/toInteger-Bor4StOs.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/type-DVCC-93H.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/marked.esm-BB_RKOA5.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/main-CCaZmKLi.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/cells-DV6dfoCq.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/kbd-BfBY_QKr.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/renderShortcut-a-3t8sis.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/useEvent-itkPNnCe.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/useDeleteCell-Ba4wqcnv.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/lazy-ijSQmhmN.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/defaultLocale-DEWTIUVh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/precisionRound-BLxyDkD7.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/defaultLocale-B9-NA0ur.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/vega-loader.browser-Cp1bHVeU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/tooltip-Yli91_uW.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/ErrorBoundary-5_63wxX3.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/alert-dialog-BZHeDuaE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/dialog-CzmSXArA.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/useDebounce--Sw2WRQ5.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/numbers-Dft9TKC1.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/SSRProvider-CMB_HLxO.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/context-BqH7Jigl.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/useNumberFormatter-BPGR7t2W.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/usePress-C2JVmCUi.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/input-DuVApvWu.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/ImperativeModal-ExH1h9et.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/cell-link-Bp_0p3CR.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/alert-B5fh2kMN.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/links-90C38wV6.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/state-BHcVA2dC.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/MarimoErrorOutput-ZIgqDBQe.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/spinner-1oeuzoUk.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/_arrayReduce-DV4IVFuG.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/startCase-RfubwhHM.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/strings-DRRWXNT2.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/command-DhuV6_de.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/popover-BoRNi4dY.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/useRunCells-WnlQjiPG.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/copy-SPzF4B1M.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/copy-CDDalEhv.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/copy-icon-Ckew1l1_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/mode-BK9SOQXS.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/purify.es-CmG1k0Cr.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/RenderHTML-BBVeCFEd.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/table-Bj1zHGNd.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/tabs-CGHt3Blh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/useAsyncData-BPaRR7vx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/useIframeCapabilities-BLQ5-OdI.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/error-banner-rdjPobI5.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/formats-Cit8Tr_y.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/useTheme-CJkb1R7C.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/en-US-Bxm1PGFP.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/isValid-CFczudfT.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/maps-cpHLsM9S.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/shim-FF_l0CN4.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/download-DrI1Gw05.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/extends-DhnjMUSs.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/emotion-is-prop-valid.esm-CjexKXdD.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/useDateFormatter-CQ9jB95h.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/range-ZclXTdAh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/table-CmDieCGZ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/Output-BNpy6qAs.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/name-cell-input-VEOAxqMs.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/useHotkey-Ca6pS8sJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/objectWithoutPropertiesLoose-CNyONSoo.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/esm-C1NahKuy.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/dist-bbz7Slba.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/dist-Duhp104c.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/dist-CH5tSYom.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/dist-Zii08NWl.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/dist-C27NmZjJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/dist-DWvYBldG.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/dist-B309G_89.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/dist-5c-fdIcP.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/dist-COzB_eCZ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/dist-BMfw4eeq.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/dist-Z76N9TEr.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/dist-C3eCrV3K.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/dist-3nYEuz31.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/apl-DOdxvsp7.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/asciiarmor-iHsvYBsh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/asn1-CjQdFpKC.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/brainfuck-DtaPUQOb.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/clike-CEj-3lIu.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/clojure-BoRNIjWi.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/cmake-BDPy65SJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/cobol-B1NZRKFh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/coffeescript-C6u-3CUG.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/commonlisp-PnS0RzOo.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/crystal-CmwgoX1x.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/css-BOMeM4Jz.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/cypher-BNcNWKra.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/d-BMO4C4Kr.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/diff-pLFk18zx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/dtd-Cufzm3tN.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/dylan-CohSy5uK.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/ecl-BhEt80nJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/eiffel-CKJVLfM7.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/elm-ClkLCCoU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/erlang-D2TH4-Et.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/simple-mode-CXCwEnyS.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/factor-6NmCZvh-.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/forth-DV7ZwZS0.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/fortran-C9_PuY2l.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/gas-CGuyKmgF.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/gherkin-BwmPTL6e.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/groovy-DJxiqoVo.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/haskell-DOcPZqkO.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/haxe-BVSsVSdX.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/idl-D5drHePd.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/javascript-rI4fd75W.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/jinja2-BrZGqXAx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/julia-z0xq3uqV.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/livescript-BbVvVfSY.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/lua-CtEmKXsU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/mathematica-B-SjlQIm.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/mbox-BdnWvTJv.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/mirc-Cyycx3am.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/mllike-ZkoLEmrh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/modelica-DIZcE54y.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/mscgen-MISBZbzR.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/mumps-Cnu1tNUa.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/nsis-CUebodQn.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/ntriples-2rre165b.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/octave-C7u5CeUZ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/oz-D5aE2uST.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/pascal-DTApZM3o.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/perl-Ckgh9LJK.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/pig-jAl9a1Kh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/powershell-C_IKzlOl.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/properties-BdVxDpDJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/protobuf-DLu_SUI6.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/pug-fgP-dIQ4.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/puppet-CShRizHW.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/python-ChTwa-ru.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/q-D2OTJZH4.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/r-DRqIAgj1.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/rpm-BStFD27m.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/ruby-C37hkPS4.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/sas-CCEIl8BG.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/scheme-B0jflgrk.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/shell-Cq7B0hFW.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/sieve-DS0lS4kt.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/smalltalk-HHM53Uii.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/sparql-BMqtnWzI.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/stylus-Br2gMpMI.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/swift-BJ8qi_zI.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/tcl-D0knbOX7.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/textile-DrRQSuh3.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/toml-C2kDGfZi.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/troff-2dFxqWQa.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/ttcn-cfg-CBXajWEo.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/ttcn-Cj4sIofh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/turtle-CDdPtp5F.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/vb-CtEhAMYU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/vbscript-B0nzdgzL.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/velocity-DR7TSall.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/verilog-MmKxT9bW.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/vhdl-0jJrpQNA.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/webidl-D9f20BkN.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/xquery-B0eSGN9q.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/yacas-BS613OH9.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/z80-CJYC52xh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/esm-DXHMyc8g.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/trash-DpmcvlCC.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/ConsoleOutput-CcWTsPJI.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/icons-HGhpVPVr.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/add-missing-import-pmcK06GU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/blob-B96v6VlX.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/add-cell-with-ai-DF_F9Sqz.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/chart-no-axes-column-C2nGNVra.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/square-function-DncO0xCM.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/spec-Cdxt7KQF.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/focus--Piy3rX5.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/useInstallPackage-B1IBfLxp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/column-preview-BavQbx6K.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/useAddCell-Ig4Te4YX.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/toggle-CPnmDQd7.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/api-qc-D7yz9.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/globals-Bcw0dX52.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/share-Bur20myQ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/dist-I8SxGjN9.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/memoize-DhF8x4Aa.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/_toKey-16owuO_q.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/_baseSet-L2qemYhz.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/utilities.esm-SfrtJjbv.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/floating-outline-CgxonLQ-.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/eye-off-BIDUS-iw.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/plus-DWAWtOBJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/readonly-python-code-ChK3PfU6.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/file-video-camera-gcIrLbdD.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/file-text-Z92DzmMA.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/file-Cesos4Qp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/types--mPsPGF4.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/label-FIGQlkj5.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/form-Cdn744fY.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/textarea-DA_SbCD5.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/circle-x-Bb-EcEyG.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/refresh-ccw-ETV_gv20.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/trash-2-D1jEfGpj.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/form-q5HZfP0M.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/field-mNGJv_67.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/switch-p-zRh0zu.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/useBoolean-CG31RE8p.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/useDeepCompareMemoize-DkEGS3Wg.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/LazyAnyLanguageCodeMirror-De4wCXx1.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/types-B_LGU134.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/prop-types-BAY7nW8B.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/es-CM14OBji.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/VisuallyHidden-B9I0t9He.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/_baseFlatten-ViL-mfkw.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/get-BUGWIXZE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/hasIn-BgJKauE7.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/_basePickBy-CSDa7ReR.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/pick-BQzWKfma.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/square-B9bfYM_2.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/download-kgdScOCd.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/globe-BGR7PZfb.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/send-C0pANzAH.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/refresh-cw-DKt4M-wV.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/settings-DvMaGwYY.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/bundle.esm-Bah18HX6.js">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/cells-BvrC6Bsv.css">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/Output-j3zW187k.css">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/ConsoleOutput-BFFTcC5Y.css">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.6/dist/assets/index-BmcO-QYJ.css">
  
<script data-marimo="true">
    window.__MARIMO_STATIC__ = {};
    window.__MARIMO_STATIC__.files = {};
</script>
</head>
  <body>
    <div id="root"></div>
    <!-- This is a portal for the data editor to render in -->
    <div id="portal" data-testid="glide-portal" style="position: fixed; left: 0; top: 0; z-index: 9999"></div>
    <script data-marimo="true">
      window.__MARIMO_MOUNT_CONFIG__ = {
            "filename": "aggregate_qc_drops.py",
            "mode": "read",
            "version": "0.17.6",
            "serverToken": "static",
            "config": {"ai": {"models": {"custom_models": [], "displayed_models": []}}, "completion": {"activate_on_typing": true, "copilot": false}, "diagnostics": {"sql_linter": true}, "display": {"cell_output": "below", "code_editor_font_size": 14, "dataframes": "rich", "default_table_max_columns": 50, "default_table_page_size": 10, "default_width": "medium", "reference_highlighting": false, "theme": "light"}, "formatting": {"line_length": 79}, "keymap": {"overrides": {}, "preset": "default"}, "language_servers": {"pylsp": {"enable_flake8": false, "enable_mypy": true, "enable_pydocstyle": false, "enable_pyflakes": false, "enable_pylint": false, "enable_ruff": true, "enabled": false}}, "mcp": {"mcpServers": {}, "presets": []}, "package_management": {"manager": "pip"}, "runtime": {"auto_instantiate": false, "auto_reload": "off", "default_sql_output": "auto", "on_cell_change": "autorun", "output_max_bytes": 8000000, "reactive_tests": true, "std_stream_max_bytes": 1000000, "watcher_on_save": "lazy"}, "save": {"autosave": "after_delay", "autosave_delay": 1000, "format_on_save": false}, "server": {"browser": "default", "follow_symlink": false}, "snippets": {"custom_paths": [], "include_default_snippets": true}},
            "configOverrides": {},
            "appConfig": {"sql_output": "auto", "width": "full"},
            "view": {"showAppCode": false},
            "notebook": {"cells": [{"code": "# Load context from pickled file.\n#\n# This cell supports multiple ways to provide context:\n# 1. Via command-line: marimo export html notebook.py -- --context-pickle path/to/context.pickle\n# 2. Via saved pickle: Manually save a context pickle to test_example/results/context_dev.pickle\n# 3. Stub context: If no pickle available, creates minimal empty context for exploration\n#\n# For interactive development with `marimo edit`, you can:\n# - Run the pipeline once to generate a real context pickle, then copy it to context_dev.pickle\n# - Or work with the stub context (downstream cells will show warnings/empty data)\n\nimport argparse\nimport os\nimport pathlib\nimport pickle\nimport sys\n\nimport marimo as mo\n\n# Check if context-pickle argument is provided (run by driver script)\nfrom_cmdline = \"--context-pickle\" in sys.argv\n\nif from_cmdline:\n    # Running via driver script - parse args\n    print(\"Loading context from command-line argument\")\n    p = argparse.ArgumentParser()\n    p.add_argument(\"--context-pickle\", required=True)\n    args = p.parse_args()\n    context_pickle_path = pathlib.Path(args.context_pickle)\nelse:\n    # Running in marimo edit - try to use development pickle\n    print(\"Running in marimo edit mode\")\n    # set `context_pickle_path` to valid pickle if running via marimo edit\n    context_pickle_path = None\n    # context_pickle_path = pathlib.Path(\"test_example/results/qc_drops/aggregate_qc_drops_context.pickle\")\n\n# Load context if pickle path exists and is valid\nif context_pickle_path and context_pickle_path.exists():\n    print(f\"Reading context from {context_pickle_path}\")\n    with open(context_pickle_path, \"rb\") as f_context:\n        context = pickle.load(f_context)\n\n    # Handle working directory\n    context_workdir = context[\"workdir\"]\n    current_workdir = os.getcwd()\n\n    if from_cmdline:\n        # Running via snakemake - verify workdir matches\n        if context_workdir != current_workdir:\n            raise RuntimeError(\n                f\"Context workdir mismatch!\\n\"\n                f\"  Context was created in: {context_workdir}\\n\"\n                f\"  Currently running in:   {current_workdir}\\n\"\n                f\"This should not happen when running via Snakemake.\"\n            )\n        print(f\"Verified working directory: {current_workdir}\")\n    else:\n        # Running in marimo edit - change to context workdir\n        if context_workdir and context_workdir != current_workdir:\n            print(f\"Changing directory from {current_workdir} to {context_workdir}\")\n            os.chdir(context_workdir)\n        elif context_workdir:\n            print(f\"Already in correct working directory: {context_workdir}\")\nelse:\n    # Create a minimal stub context for interactive development\n    print(\"Creating minimal stub context that you need to complete\")\n    context = {\n        \"input\": {},\n        \"output\": {},\n        \"params\": {},\n        \"wildcards\": {},\n        \"threads\": 1,\n        \"resources\": {},\n    }", "code_hash": "05b90526b9873d393eb0ac3b8c1c9b01", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Hbol", "name": "_"}, {"code": "# Extract variables from context - raises KeyError if required keys missing\ninput_plate_qc_drops = context[\"input\"][\"plate_qc_drops\"]\ninput_groups_sera_qc_drops = context[\"input\"][\"groups_sera_qc_drops\"]\noutput_plate_qc_drops = context[\"output\"][\"plate_qc_drops\"]\noutput_barcode_qc_drops = context[\"output\"][\"barcode_qc_drops\"]\noutput_groups_sera_qc_drops = context[\"output\"][\"groups_sera_qc_drops\"]\nplates = context[\"params\"][\"plates\"]\ngroups_sera = context[\"params\"][\"groups_sera\"]\n\n# Show informative message about context mode\nif not context[\"input\"]:\n    mo.output.append(\n        mo.callout(\n            mo.md(\n                \"**\u26a0\ufe0f Running in interactive mode with stub context**\\n\\n\"\n                \"To run with real data:\\n\"\n                \"1. Run the pipeline to generate a context pickle\\n\"\n                \"2. Copy it to `test_example/results/context_dev.pickle`\\n\"\n                \"3. Or run: `marimo export html notebook.py -- --context-pickle path/to/context.pickle`\"\n            ),\n            kind=\"warn\",\n        )\n    )", "code_hash": "c8d58c53dedcd3268f12a615514797ee", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "MJUe", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\n# Aggregate and analyze the drops from QC-ing the plates and sera\n\"\"\"\n)", "code_hash": "c8a50a58f1d53b17c3800a09eea37c48", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "vblA", "name": "_"}, {"code": "import altair as alt\n\nimport pandas as pd\n\nfrom ruamel.yaml import YAML\n\nyaml = YAML(typ=\"rt\")\n\n_ = alt.data_transformers.disable_max_rows()", "code_hash": "e7ebe3b97b9147d2134f07a490188020", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "bkHC", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\n## Analyze plate QC drops\nRead QC drops for individual plates into a merged dictionary, write it to YAML, and also convert to a DataFrame.\nIf you really want to look into the details of what is being dropped, you will want to look at that merged YAML file.\n\"\"\"\n)", "code_hash": "5cbc7c8dfe0ca79844bc5e137879e421", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "lEQa", "name": "_"}, {"code": "# read dictionary of QC drops\nassert len(plates) == len(input_plate_qc_drops)\nplate_qc_drops = {}\nfor _plate, _qc_drops_yaml in zip(plates, input_plate_qc_drops):\n    with open(_qc_drops_yaml) as _f:\n        plate_qc_drops[_plate] = yaml.load(_f)\nassert len(plate_qc_drops) == len(input_plate_qc_drops)\n\nmo.output.append(mo.md(f\"Writing merged plate drops to {output_plate_qc_drops}\"))\nwith open(output_plate_qc_drops, \"w\") as _f:\n    yaml.dump(plate_qc_drops, stream=_f)\n\n# convert dictionary of QC drops into list of tuples\nplate_qc_drop_tups = [\n    (plate_key, droptype_key, drop_key, reason)\n    for plate_key, plate_val in plate_qc_drops.items()\n    for droptype_key, droptype_val in plate_val.items()\n    for drop_key, reason in droptype_val.items()\n]\n\n# create data frame of QC drops\nplate_qc_drops_df = pd.DataFrame(\n    plate_qc_drop_tups, columns=[\"plate\", \"drop type\", \"drop\", \"reason\"]\n)", "code_hash": "b69064ad410179b946621c9bfe068c27", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "PKri", "name": "_"}, {"code": "plate_qc_drop_counts = plate_qc_drops_df.groupby(\n    [\"plate\", \"drop type\", \"reason\"], as_index=False\n).aggregate(n_drops=pd.NamedAgg(\"drop\", \"nunique\"))\nassert plate_qc_drop_counts[\"n_drops\"].sum() == len(plate_qc_drops_df)", "code_hash": "8cb0f81f15ca6ec9e30c6f2f877e3473", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Xref", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\nNow plot the number of drops for each plate.\nYou should be worried (maybe re-do or discard) any plates with a very large number of drops:\n\"\"\"\n)", "code_hash": "43c029b854f1b42a72aafe2263f18bd5", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "SFPL", "name": "_"}, {"code": "plate_selection = alt.selection_point(fields=[\"plate\"], on=\"mouseover\", empty=False)\n\nplate_qc_drop_counts_chart = (\n    alt.Chart(plate_qc_drop_counts)\n    .add_params(plate_selection)\n    .encode(\n        alt.X(\n            \"n_drops\",\n            title=\"number of drops\",\n        ),\n        alt.Y(\n            \"plate\",\n            sort=plates,\n            title=None,\n            axis=alt.Axis(labelFontStyle=\"bold\", labelFontSize=11),\n        ),\n        alt.Column(\n            \"drop type\",\n            title=None,\n            spacing=5,\n            header=alt.Header(\n                labelFontSize=12, labelFontStyle=\"bold\", labelPadding=1\n            ),\n        ),\n        alt.Color(\n            \"reason\",\n            legend=alt.Legend(\n                orient=\"top\", columns=1, labelLimit=230, title=None, padding=1\n            ),\n        ),\n        strokeWidth=alt.condition(plate_selection, alt.value(3), alt.value(0.5)),\n        tooltip=plate_qc_drop_counts.columns.tolist(),\n    )\n    .mark_bar(height={\"band\": 0.8}, stroke=\"black\")\n    .properties(\n        width=230,\n        height=alt.Step(16),\n        title=alt.TitleParams(\n            \"Number of QC drops when processing plates\", anchor=\"middle\", dy=-2\n        ),\n    )\n    .configure_axis(grid=False)\n    .resolve_scale(color=\"independent\", x=\"independent\")\n)\n\nplate_qc_drop_counts_chart", "code_hash": "4c5e5eec890eec24cd602254db1b56a7", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "BYtC", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\n## Analyze barcode QC drops\nIf a barcode is dropped especially often across plates, that could indicate something problematic with that barcode such that it should be removed altogether from the library analysis.\n\nFirst, write a YAML with this information:\n\"\"\"\n)", "code_hash": "4980081b03e62db7b18756459cfeb381", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "RGSE", "name": "_"}, {"code": "barcode_qc_drops = {}\n\nfor _plate, plate_d in plate_qc_drops.items():\n    for key, val in [\n        tup for tup in plate_d.items() if tup[0].startswith(\"barcode\") and tup[1]\n    ]:\n        for desc, reason in val.items():\n            desc_entries = desc.split(None, maxsplit=1)\n            barcode = desc_entries[0]\n            if len(desc_entries) == 2:\n                description = f\"{_plate} {desc_entries[1]}\"\n            elif len(desc_entries) == 1:\n                description = _plate\n            else:\n                raise RuntimeError(\"should not get here\")\n            if barcode not in barcode_qc_drops:\n                barcode_qc_drops[barcode] = {}\n            if key not in barcode_qc_drops[barcode]:\n                barcode_qc_drops[barcode][key] = {}\n            barcode_qc_drops[barcode][key][description] = reason\n\n# sort keys\ndef sort_nested(d):\n    if isinstance(d, dict):\n        return dict(sorted((key, sort_nested(val)) for key, val in d.items()))\n    else:\n        return d\n\nbarcode_qc_drops = sort_nested(barcode_qc_drops)\n\nmo.output.append(\n    mo.md((f\"Writing merged barcode drops to {output_barcode_qc_drops}\"))\n)\nwith open(output_barcode_qc_drops, \"w\") as _f:\n    yaml.dump(barcode_qc_drops, stream=_f)", "code_hash": "90d6214b04b2605161131a6310164345", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Kclp", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\nNow make a plot showing how often each barcode is dropped for each reason:\n\"\"\"\n)", "code_hash": "4283bb493c2da0ef2b513865efece54c", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "emfo", "name": "_"}, {"code": "barcode_drops = (\n    plate_qc_drops_df.query(\"`drop type`.str.startswith('barcode')\")\n    .assign(barcode=lambda x: x[\"drop\"].str.split().str[0])\n    .groupby([\"drop type\", \"barcode\"], as_index=False)\n    .aggregate(\n        plates_where_dropped=pd.NamedAgg(\"plate\", \"nunique\"),\n        total_drops=pd.NamedAgg(\"plate\", \"count\"),\n    )\n)", "code_hash": "f7e5c76d8e66907236b526dd8362b693", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Hstk", "name": "_"}, {"code": "barcode_selection = alt.selection_point(\n    fields=[\"barcode\"], on=\"mouseover\", empty=False\n)\n\nbarcode_drops_chart = (\n    alt.Chart(barcode_drops)\n    .add_params(barcode_selection)\n    .encode(\n        alt.X(\n            \"total_drops\",\n            title=\"times barcode dropped\",\n        ),\n        alt.Y(\n            \"barcode\",\n            sort=alt.SortField(\"total_drops\", order=\"descending\"),\n            axis=alt.Axis(labelFontSize=9),\n        ),\n        alt.Column(\n            \"drop type\",\n            title=None,\n            spacing=8,\n            header=alt.Header(\n                labelFontSize=12, labelFontStyle=\"bold\", labelPadding=1\n            ),\n        ),\n        strokeWidth=alt.condition(barcode_selection, alt.value(3), alt.value(0.5)),\n        tooltip=barcode_drops.columns.tolist(),\n    )\n    .mark_bar(height={\"band\": 0.8}, stroke=\"black\")\n    .properties(\n        width=200,\n        height=alt.Step(10),\n        title=alt.TitleParams(\n            \"Number of QC drops when processing plates\", anchor=\"middle\", dy=-2\n        ),\n    )\n    .configure_axis(grid=False)\n    .resolve_scale(color=\"independent\", x=\"independent\", y=\"independent\")\n)\n\nbarcode_drops_chart", "code_hash": "ebe3dc847a2a8312fa636ad564676c96", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "nWHF", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\n## Analyze the groups/sera QC\nAnalyze the QC performed on the groups/sera, which involves completely dropping titers for certain virus-sera pairs.\n\nRead the QC for different groups/sera into a merged dictionary, write it to YAML, and also convert to a DataFrame.\nIf you really want to look into the details of what is being dropped, you will want to look at that merged YAML file.\n\"\"\"\n)", "code_hash": "6340fb0951d5247ae104fa96d223d19d", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "iLit", "name": "_"}, {"code": "# read dictionary of QC drops\nassert len(groups_sera) == len(input_groups_sera_qc_drops)\ngroups_sera_qc_drops = {}\nfor (group, serum), _qc_drops_yaml in zip(groups_sera, input_groups_sera_qc_drops):\n    if group not in groups_sera_qc_drops:\n        groups_sera_qc_drops[group] = {}\n    with open(_qc_drops_yaml) as _f:\n        groups_sera_qc_drops[group][serum] = yaml.load(_f)\n\nmo.output.append(\n    mo.md(f\"Writing merged groups/sera drops to {output_groups_sera_qc_drops}\")\n)\nwith open(output_groups_sera_qc_drops, \"w\") as _f:\n    yaml.dump(groups_sera_qc_drops, stream=_f)\n\n# convert dictionary of QC drops into list of tuples\ngroups_sera_qc_drop_tups = [\n    (group_key, serum_key, virus, reason)\n    for group_key, group_val in groups_sera_qc_drops.items()\n    for serum_key, serum_val in group_val.items()\n    for virus, reason in serum_val.items()\n]\n\n# create data frame of QC drops\ngroups_sera_qc_drops_df = pd.DataFrame(\n    groups_sera_qc_drop_tups, columns=[\"group\", \"serum\", \"virus\", \"reason\"]\n)", "code_hash": "85058d1ff301ce203056551a79d58a49", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "ZHCJ", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\nPlot the number of viruses dropped for each group/serum.\nIf a group/serum has many missed viruses, then you will lack a lot of titers and so it may be worth reviewing the cause of the drops.\n\"\"\"\n)", "code_hash": "687a69572c791df824768b8528d5f4c4", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "ROlb", "name": "_"}, {"code": "groups_sera_n_drops = groups_sera_qc_drops_df.groupby(\n    [\"group\", \"serum\", \"reason\"], as_index=False\n).aggregate(n_viruses=pd.NamedAgg(\"virus\", \"nunique\"))\nassert groups_sera_n_drops[\"n_viruses\"].sum() == len(groups_sera_qc_drops_df)\n\ngroups_sera_n_drops_chart = (\n    alt.Chart(groups_sera_n_drops)\n    .encode(\n        alt.X(\"n_viruses\", title=\"number of viruses dropped\"),\n        alt.Y(\"serum\"),\n        alt.Row(\"group\"),\n        alt.Color(\n            \"reason\", title=\"reason dropped\", legend=alt.Legend(labelLimit=350)\n        ),\n        tooltip=groups_sera_n_drops.columns.tolist(),\n    )\n    .mark_bar(height={\"band\": 0.8})\n    .properties(\n        width=250,\n        height=alt.Step(13),\n        title=\"Number of viruses dropped at serum QC for each serum\",\n    )\n    .configure_axis(grid=False)\n    .resolve_scale(y=\"independent\", x=\"independent\")\n)\n\ngroups_sera_n_drops_chart", "code_hash": "17f4c05e98a5147dcc1d6035d20fb9af", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "qnkX", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\nPlot the number of sera for which each virus is dropped during serum QC.\nIf a virus is dropped for many sera, that may indicate some issue with that virus in assays:\n\"\"\"\n)", "code_hash": "42d07d5e3b31d72117bb92979e93979b", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "TqIu", "name": "_"}, {"code": "virus_n_drops = groups_sera_qc_drops_df.groupby(\n    [\"group\", \"virus\", \"reason\"], as_index=False\n).aggregate(n_sera=pd.NamedAgg(\"serum\", \"nunique\"))\nassert virus_n_drops[\"n_sera\"].sum() == len(groups_sera_qc_drops_df)\n\nvirus_n_drops_chart = (\n    alt.Chart(virus_n_drops)\n    .encode(\n        alt.X(\"n_sera\", title=\"number of sera for which virus is dropped\"),\n        alt.Y(\"virus\", sort=alt.SortField(\"n_sera\", order=\"descending\")),\n        alt.Row(\"group\"),\n        alt.Color(\n            \"reason\", title=\"reason dropped\", legend=alt.Legend(labelLimit=350)\n        ),\n        tooltip=virus_n_drops.columns.tolist(),\n    )\n    .mark_bar(height={\"band\": 0.8})\n    .properties(\n        width=250,\n        height=alt.Step(13),\n        title=\"Number of sera for which each virus is dropped at serum QC\",\n    )\n    .configure_axis(grid=False)\n    .resolve_scale(y=\"independent\", x=\"independent\")\n)\n\nvirus_n_drops_chart", "code_hash": "baf992685b9dcb85555216d8f7daac5e", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Vxnm", "name": "_"}], "metadata": {"marimo_version": "0.17.6"}, "version": "1"},
            "session": {"cells": [{"code_hash": "05b90526b9873d393eb0ac3b8c1c9b01", "console": [{"mimetype": "text/plain", "name": "stdout", "text": "Loading context from command-line argument\nReading context from results/qc_drops/aggregate_qc_drops_context.pickle\n", "type": "stream"}, {"mimetype": "text/plain", "name": "stdout", "text": "Verified working directory: /fh/fast/bloom_j/computational_notebooks/aloes/2026/250107_testrepo/flu_seqneut_pdmH1N1_2023-2024_VaccinatedCohorts\n", "type": "stream"}], "id": "Hbol", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "c8d58c53dedcd3268f12a615514797ee", "console": [], "id": "MJUe", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "c8a50a58f1d53b17c3800a09eea37c48", "console": [], "id": "vblA", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch1 id=\"aggregate-and-analyze-the-drops-from-qc-ing-the-plates-and-sera\"\u003EAggregate and analyze the drops from QC-ing the plates and sera\u003C/h1\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "e7ebe3b97b9147d2134f07a490188020", "console": [], "id": "bkHC", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "5cbc7c8dfe0ca79844bc5e137879e421", "console": [], "id": "lEQa", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch2 id=\"analyze-plate-qc-drops\"\u003EAnalyze plate QC drops\u003C/h2\u003E\n\u003Cspan class=\"paragraph\"\u003ERead QC drops for individual plates into a merged dictionary, write it to YAML, and also convert to a DataFrame.\nIf you really want to look into the details of what is being dropped, you will want to look at that merged YAML file.\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "b69064ad410179b946621c9bfe068c27", "console": [], "id": "PKri", "outputs": [{"data": {"text/html": "\u003Cdiv style='display: flex;flex: 1;flex-direction: column;justify-content: flex-start;align-items: normal;flex-wrap: nowrap;gap: 0.5rem'\u003E\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003EWriting merged plate drops to results/qc_drops/plate_qc_drops.yml\u003C/span\u003E\u003C/span\u003E\u003C/div\u003E"}, "type": "data"}]}, {"code_hash": "8cb0f81f15ca6ec9e30c6f2f877e3473", "console": [], "id": "Xref", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "43c029b854f1b42a72aafe2263f18bd5", "console": [], "id": "SFPL", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003ENow plot the number of drops for each plate.\nYou should be worried (maybe re-do or discard) any plates with a very large number of drops:\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "4c5e5eec890eec24cd602254db1b56a7", "console": [], "id": "BYtC", "outputs": [{"data": {"application/vnd.vegalite.v5+json": "{\n  \"$schema\": \"https://vega.github.io/schema/vega-lite/v5.20.1.json\",\n  \"config\": {\n    \"axis\": {\n      \"grid\": false\n    },\n    \"view\": {\n      \"continuousHeight\": 300,\n      \"continuousWidth\": 300\n    }\n  },\n  \"data\": {\n    \"name\": \"data-e2d296efdb41c883c8b383c6366c522e\"\n  },\n  \"datasets\": {\n    \"data-e2d296efdb41c883c8b383c6366c522e\": [\n      {\n        \"drop type\": \"barcode_serum_replicates\",\n        \"n_drops\": 2,\n        \"plate\": \"plate1\",\n        \"reason\": \"goodness_of_fit\"\n      },\n      {\n        \"drop type\": \"barcode_wells\",\n        \"n_drops\": 29,\n        \"plate\": \"plate1\",\n        \"reason\": \"max_frac_infectivity_per_viral_barcode_well\"\n      },\n      {\n        \"drop type\": \"barcodes\",\n        \"n_drops\": 4,\n        \"plate\": \"plate1\",\n        \"reason\": \"min_neut_standard_frac_per_well\"\n      },\n      {\n        \"drop type\": \"barcode_serum_replicates\",\n        \"n_drops\": 9,\n        \"plate\": \"plate10\",\n        \"reason\": \"goodness_of_fit\"\n      },\n      {\n        \"drop type\": \"barcode_wells\",\n        \"n_drops\": 9,\n        \"plate\": \"plate10\",\n        \"reason\": \"max_frac_infectivity_per_viral_barcode_well\"\n      },\n      {\n        \"drop type\": \"barcode_wells\",\n        \"n_drops\": 2,\n        \"plate\": \"plate10\",\n        \"reason\": \"min_no_serum_count_per_viral_barcode_well\"\n      },\n      {\n        \"drop type\": \"barcodes\",\n        \"n_drops\": 5,\n        \"plate\": \"plate10\",\n        \"reason\": \"min_neut_standard_frac_per_well\"\n      },\n      {\n        \"drop type\": \"barcode_serum_replicates\",\n        \"n_drops\": 2,\n        \"plate\": \"plate11\",\n        \"reason\": \"goodness_of_fit\"\n      },\n      {\n        \"drop type\": \"barcode_wells\",\n        \"n_drops\": 38,\n        \"plate\": \"plate11\",\n        \"reason\": \"max_frac_infectivity_per_viral_barcode_well\"\n      },\n      {\n        \"drop type\": \"barcodes\",\n        \"n_drops\": 4,\n        \"plate\": \"plate11\",\n        \"reason\": \"min_neut_standard_frac_per_well\"\n      },\n      {\n        \"drop type\": \"barcode_serum_replicates\",\n        \"n_drops\": 4,\n        \"plate\": \"plate12\",\n        \"reason\": \"goodness_of_fit\"\n      },\n      {\n        \"drop type\": \"barcode_wells\",\n        \"n_drops\": 44,\n        \"plate\": \"plate12\",\n        \"reason\": \"max_frac_infectivity_per_viral_barcode_well\"\n      },\n      {\n        \"drop type\": \"barcodes\",\n        \"n_drops\": 6,\n        \"plate\": \"plate12\",\n        \"reason\": \"min_neut_standard_frac_per_well\"\n      },\n      {\n        \"drop type\": \"barcode_serum_replicates\",\n        \"n_drops\": 10,\n        \"plate\": \"plate13\",\n        \"reason\": \"goodness_of_fit\"\n      },\n      {\n        \"drop type\": \"barcode_wells\",\n        \"n_drops\": 24,\n        \"plate\": \"plate13\",\n        \"reason\": \"max_frac_infectivity_per_viral_barcode_well\"\n      },\n      {\n        \"drop type\": \"barcode_wells\",\n        \"n_drops\": 1,\n        \"plate\": \"plate13\",\n        \"reason\": \"min_no_serum_count_per_viral_barcode_well\"\n      },\n      {\n        \"drop type\": \"barcodes\",\n        \"n_drops\": 6,\n        \"plate\": \"plate13\",\n        \"reason\": \"min_neut_standard_frac_per_well\"\n      },\n      {\n        \"drop type\": \"barcode_serum_replicates\",\n        \"n_drops\": 1,\n        \"plate\": \"plate14\",\n        \"reason\": \"goodness_of_fit\"\n      },\n      {\n        \"drop type\": \"barcode_wells\",\n        \"n_drops\": 3,\n        \"plate\": \"plate14\",\n        \"reason\": \"max_frac_infectivity_per_viral_barcode_well\"\n      },\n      {\n        \"drop type\": \"barcodes\",\n        \"n_drops\": 6,\n        \"plate\": \"plate14\",\n        \"reason\": \"min_neut_standard_frac_per_well\"\n      },\n      {\n        \"drop type\": \"barcode_serum_replicates\",\n        \"n_drops\": 5,\n        \"plate\": \"plate15\",\n        \"reason\": \"goodness_of_fit\"\n      },\n      {\n        \"drop type\": \"barcode_wells\",\n        \"n_drops\": 9,\n        \"plate\": \"plate15\",\n        \"reason\": \"max_frac_infectivity_per_viral_barcode_well\"\n      },\n      {\n        \"drop type\": \"barcodes\",\n        \"n_drops\": 5,\n        \"plate\": \"plate15\",\n        \"reason\": \"min_neut_standard_frac_per_well\"\n      },\n      {\n        \"drop type\": \"barcode_serum_replicates\",\n        \"n_drops\": 4,\n        \"plate\": \"plate16\",\n        \"reason\": \"goodness_of_fit\"\n      },\n      {\n        \"drop type\": \"barcode_wells\",\n        \"n_drops\": 1,\n        \"plate\": \"plate16\",\n        \"reason\": \"max_frac_infectivity_per_viral_barcode_well\"\n      },\n      {\n        \"drop type\": \"barcode_wells\",\n        \"n_drops\": 3,\n        \"plate\": \"plate16\",\n        \"reason\": \"min_no_serum_count_per_viral_barcode_well\"\n      },\n      {\n        \"drop type\": \"barcodes\",\n        \"n_drops\": 5,\n        \"plate\": \"plate16\",\n        \"reason\": \"min_neut_standard_frac_per_well\"\n      },\n      {\n        \"drop type\": \"wells\",\n        \"n_drops\": 1,\n        \"plate\": \"plate16\",\n        \"reason\": \"avg_barcode_counts_per_well\"\n      },\n      {\n        \"drop type\": \"barcode_serum_replicates\",\n        \"n_drops\": 7,\n        \"plate\": \"plate17\",\n        \"reason\": \"goodness_of_fit\"\n      },\n      {\n        \"drop type\": \"barcode_wells\",\n        \"n_drops\": 6,\n        \"plate\": \"plate17\",\n        \"reason\": \"max_frac_infectivity_per_viral_barcode_well\"\n      },\n      {\n        \"drop type\": \"barcode_wells\",\n        \"n_drops\": 4,\n        \"plate\": \"plate17\",\n        \"reason\": \"min_no_serum_count_per_viral_barcode_well\"\n      },\n      {\n        \"drop type\": \"barcodes\",\n        \"n_drops\": 5,\n        \"plate\": \"plate17\",\n        \"reason\": \"min_neut_standard_frac_per_well\"\n      },\n      {\n        \"drop type\": \"wells\",\n        \"n_drops\": 1,\n        \"plate\": \"plate17\",\n        \"reason\": \"avg_barcode_counts_per_well\"\n      },\n      {\n        \"drop type\": \"barcode_serum_replicates\",\n        \"n_drops\": 5,\n        \"plate\": \"plate18\",\n        \"reason\": \"goodness_of_fit\"\n      },\n      {\n        \"drop type\": \"barcode_wells\",\n        \"n_drops\": 4,\n        \"plate\": \"plate18\",\n        \"reason\": \"max_frac_infectivity_per_viral_barcode_well\"\n      },\n      {\n        \"drop type\": \"barcode_wells\",\n        \"n_drops\": 3,\n        \"plate\": \"plate18\",\n        \"reason\": \"min_no_serum_count_per_viral_barcode_well\"\n      },\n      {\n        \"drop type\": \"barcodes\",\n        \"n_drops\": 1,\n        \"plate\": \"plate18\",\n        \"reason\": \"manual_drop\"\n      },\n      {\n        \"drop type\": \"barcodes\",\n        \"n_drops\": 5,\n        \"plate\": \"plate18\",\n        \"reason\": \"min_neut_standard_frac_per_well\"\n      },\n      {\n        \"drop type\": \"wells\",\n        \"n_drops\": 1,\n        \"plate\": \"plate18\",\n        \"reason\": \"avg_barcode_counts_per_well\"\n      },\n      {\n        \"drop type\": \"barcode_serum_replicates\",\n        \"n_drops\": 11,\n        \"plate\": \"plate19\",\n        \"reason\": \"goodness_of_fit\"\n      },\n      {\n        \"drop type\": \"barcode_wells\",\n        \"n_drops\": 6,\n        \"plate\": \"plate19\",\n        \"reason\": \"max_frac_infectivity_per_viral_barcode_well\"\n      },\n      {\n        \"drop type\": \"barcode_wells\",\n        \"n_drops\": 2,\n        \"plate\": \"plate19\",\n        \"reason\": \"min_no_serum_count_per_viral_barcode_well\"\n      },\n      {\n        \"drop type\": \"barcodes\",\n        \"n_drops\": 6,\n        \"plate\": \"plate19\",\n        \"reason\": \"min_neut_standard_frac_per_well\"\n      },\n      {\n        \"drop type\": \"wells\",\n        \"n_drops\": 1,\n        \"plate\": \"plate19\",\n        \"reason\": \"avg_barcode_counts_per_well\"\n      },\n      {\n        \"drop type\": \"barcode_serum_replicates\",\n        \"n_drops\": 5,\n        \"plate\": \"plate20\",\n        \"reason\": \"goodness_of_fit\"\n      },\n      {\n        \"drop type\": \"barcode_wells\",\n        \"n_drops\": 5,\n        \"plate\": \"plate20\",\n        \"reason\": \"max_frac_infectivity_per_viral_barcode_well\"\n      },\n      {\n        \"drop type\": \"barcodes\",\n        \"n_drops\": 6,\n        \"plate\": \"plate20\",\n        \"reason\": \"min_neut_standard_frac_per_well\"\n      },\n      {\n        \"drop type\": \"barcode_serum_replicates\",\n        \"n_drops\": 13,\n        \"plate\": \"plate21\",\n        \"reason\": \"goodness_of_fit\"\n      },\n      {\n        \"drop type\": \"barcode_wells\",\n        \"n_drops\": 4,\n        \"plate\": \"plate21\",\n        \"reason\": \"max_frac_infectivity_per_viral_barcode_well\"\n      },\n      {\n        \"drop type\": \"barcodes\",\n        \"n_drops\": 6,\n        \"plate\": \"plate21\",\n        \"reason\": \"min_neut_standard_frac_per_well\"\n      },\n      {\n        \"drop type\": \"barcode_serum_replicates\",\n        \"n_drops\": 8,\n        \"plate\": \"plate22\",\n        \"reason\": \"goodness_of_fit\"\n      },\n      {\n        \"drop type\": \"barcode_wells\",\n        \"n_drops\": 9,\n        \"plate\": \"plate22\",\n        \"reason\": \"max_frac_infectivity_per_viral_barcode_well\"\n      },\n      {\n        \"drop type\": \"barcodes\",\n        \"n_drops\": 6,\n        \"plate\": \"plate22\",\n        \"reason\": \"min_neut_standard_frac_per_well\"\n      },\n      {\n        \"drop type\": \"barcode_serum_replicates\",\n        \"n_drops\": 6,\n        \"plate\": \"plate3\",\n        \"reason\": \"goodness_of_fit\"\n      },\n      {\n        \"drop type\": \"barcode_wells\",\n        \"n_drops\": 7,\n        \"plate\": \"plate3\",\n        \"reason\": \"max_frac_infectivity_per_viral_barcode_well\"\n      },\n      {\n        \"drop type\": \"barcodes\",\n        \"n_drops\": 4,\n        \"plate\": \"plate3\",\n        \"reason\": \"min_neut_standard_frac_per_well\"\n      },\n      {\n        \"drop type\": \"serum_replicates\",\n        \"n_drops\": 2,\n        \"plate\": \"plate3\",\n        \"reason\": \"manual_drop\"\n      },\n      {\n        \"drop type\": \"barcode_serum_replicates\",\n        \"n_drops\": 11,\n        \"plate\": \"plate4\",\n        \"reason\": \"goodness_of_fit\"\n      },\n      {\n        \"drop type\": \"barcode_wells\",\n        \"n_drops\": 7,\n        \"plate\": \"plate4\",\n        \"reason\": \"max_frac_infectivity_per_viral_barcode_well\"\n      },\n      {\n        \"drop type\": \"barcodes\",\n        \"n_drops\": 4,\n        \"plate\": \"plate4\",\n        \"reason\": \"min_neut_standard_frac_per_well\"\n      },\n      {\n        \"drop type\": \"wells\",\n        \"n_drops\": 1,\n        \"plate\": \"plate4\",\n        \"reason\": \"avg_barcode_counts_per_well\"\n      },\n      {\n        \"drop type\": \"barcode_serum_replicates\",\n        \"n_drops\": 21,\n        \"plate\": \"plate5\",\n        \"reason\": \"goodness_of_fit\"\n      },\n      {\n        \"drop type\": \"barcode_wells\",\n        \"n_drops\": 120,\n        \"plate\": \"plate5\",\n        \"reason\": \"max_frac_infectivity_per_viral_barcode_well\"\n      },\n      {\n        \"drop type\": \"barcodes\",\n        \"n_drops\": 4,\n        \"plate\": \"plate5\",\n        \"reason\": \"min_neut_standard_frac_per_well\"\n      },\n      {\n        \"drop type\": \"serum_replicates\",\n        \"n_drops\": 2,\n        \"plate\": \"plate5\",\n        \"reason\": \"manual_drop\"\n      },\n      {\n        \"drop type\": \"wells\",\n        \"n_drops\": 2,\n        \"plate\": \"plate5\",\n        \"reason\": \"avg_barcode_counts_per_well\"\n      },\n      {\n        \"drop type\": \"barcode_serum_replicates\",\n        \"n_drops\": 4,\n        \"plate\": \"plate6\",\n        \"reason\": \"goodness_of_fit\"\n      },\n      {\n        \"drop type\": \"barcode_wells\",\n        \"n_drops\": 191,\n        \"plate\": \"plate6\",\n        \"reason\": \"max_frac_infectivity_per_viral_barcode_well\"\n      },\n      {\n        \"drop type\": \"barcode_wells\",\n        \"n_drops\": 1,\n        \"plate\": \"plate6\",\n        \"reason\": \"min_no_serum_count_per_viral_barcode_well\"\n      },\n      {\n        \"drop type\": \"barcodes\",\n        \"n_drops\": 4,\n        \"plate\": \"plate6\",\n        \"reason\": \"min_neut_standard_frac_per_well\"\n      },\n      {\n        \"drop type\": \"serum_replicates\",\n        \"n_drops\": 2,\n        \"plate\": \"plate6\",\n        \"reason\": \"manual_drop\"\n      },\n      {\n        \"drop type\": \"wells\",\n        \"n_drops\": 8,\n        \"plate\": \"plate6\",\n        \"reason\": \"manual_drop\"\n      },\n      {\n        \"drop type\": \"barcode_serum_replicates\",\n        \"n_drops\": 10,\n        \"plate\": \"plate7\",\n        \"reason\": \"goodness_of_fit\"\n      },\n      {\n        \"drop type\": \"barcode_wells\",\n        \"n_drops\": 25,\n        \"plate\": \"plate7\",\n        \"reason\": \"max_frac_infectivity_per_viral_barcode_well\"\n      },\n      {\n        \"drop type\": \"barcodes\",\n        \"n_drops\": 4,\n        \"plate\": \"plate7\",\n        \"reason\": \"min_neut_standard_frac_per_well\"\n      },\n      {\n        \"drop type\": \"barcode_serum_replicates\",\n        \"n_drops\": 3,\n        \"plate\": \"plate8\",\n        \"reason\": \"goodness_of_fit\"\n      },\n      {\n        \"drop type\": \"barcode_wells\",\n        \"n_drops\": 14,\n        \"plate\": \"plate8\",\n        \"reason\": \"max_frac_infectivity_per_viral_barcode_well\"\n      },\n      {\n        \"drop type\": \"barcodes\",\n        \"n_drops\": 4,\n        \"plate\": \"plate8\",\n        \"reason\": \"min_neut_standard_frac_per_well\"\n      },\n      {\n        \"drop type\": \"wells\",\n        \"n_drops\": 1,\n        \"plate\": \"plate8\",\n        \"reason\": \"manual_drop\"\n      },\n      {\n        \"drop type\": \"barcode_serum_replicates\",\n        \"n_drops\": 9,\n        \"plate\": \"plate9\",\n        \"reason\": \"goodness_of_fit\"\n      },\n      {\n        \"drop type\": \"barcode_wells\",\n        \"n_drops\": 7,\n        \"plate\": \"plate9\",\n        \"reason\": \"max_frac_infectivity_per_viral_barcode_well\"\n      },\n      {\n        \"drop type\": \"barcode_wells\",\n        \"n_drops\": 2,\n        \"plate\": \"plate9\",\n        \"reason\": \"min_no_serum_count_per_viral_barcode_well\"\n      },\n      {\n        \"drop type\": \"barcodes\",\n        \"n_drops\": 4,\n        \"plate\": \"plate9\",\n        \"reason\": \"min_neut_standard_frac_per_well\"\n      }\n    ]\n  },\n  \"encoding\": {\n    \"color\": {\n      \"field\": \"reason\",\n      \"legend\": {\n        \"columns\": 1,\n        \"labelLimit\": 230,\n        \"orient\": \"top\",\n        \"padding\": 1,\n        \"title\": null\n      },\n      \"type\": \"nominal\"\n    },\n    \"column\": {\n      \"field\": \"drop type\",\n      \"header\": {\n        \"labelFontSize\": 12,\n        \"labelFontStyle\": \"bold\",\n        \"labelPadding\": 1\n      },\n      \"spacing\": 5,\n      \"title\": null,\n      \"type\": \"nominal\"\n    },\n    \"strokeWidth\": {\n      \"condition\": {\n        \"empty\": false,\n        \"param\": \"param_1\",\n        \"value\": 3\n      },\n      \"value\": 0.5\n    },\n    \"tooltip\": [\n      {\n        \"field\": \"plate\",\n        \"type\": \"nominal\"\n      },\n      {\n        \"field\": \"drop type\",\n        \"type\": \"nominal\"\n      },\n      {\n        \"field\": \"reason\",\n        \"type\": \"nominal\"\n      },\n      {\n        \"field\": \"n_drops\",\n        \"type\": \"quantitative\"\n      }\n    ],\n    \"x\": {\n      \"field\": \"n_drops\",\n      \"title\": \"number of drops\",\n      \"type\": \"quantitative\"\n    },\n    \"y\": {\n      \"axis\": {\n        \"labelFontSize\": 11,\n        \"labelFontStyle\": \"bold\"\n      },\n      \"field\": \"plate\",\n      \"sort\": [\n        \"plate1\",\n        \"plate3\",\n        \"plate4\",\n        \"plate5\",\n        \"plate6\",\n        \"plate7\",\n        \"plate8\",\n        \"plate9\",\n        \"plate10\",\n        \"plate11\",\n        \"plate12\",\n        \"plate13\",\n        \"plate14\",\n        \"plate15\",\n        \"plate16\",\n        \"plate17\",\n        \"plate18\",\n        \"plate19\",\n        \"plate20\",\n        \"plate21\",\n        \"plate22\"\n      ],\n      \"title\": null,\n      \"type\": \"nominal\"\n    }\n  },\n  \"height\": {\n    \"step\": 16\n  },\n  \"mark\": {\n    \"height\": {\n      \"band\": 0.8\n    },\n    \"stroke\": \"black\",\n    \"type\": \"bar\"\n  },\n  \"params\": [\n    {\n      \"name\": \"param_1\",\n      \"select\": {\n        \"fields\": [\n          \"plate\"\n        ],\n        \"on\": \"mouseover\",\n        \"type\": \"point\"\n      }\n    }\n  ],\n  \"resolve\": {\n    \"scale\": {\n      \"color\": \"independent\",\n      \"x\": \"independent\"\n    }\n  },\n  \"title\": {\n    \"anchor\": \"middle\",\n    \"dy\": -2,\n    \"text\": \"Number of QC drops when processing plates\"\n  },\n  \"usermeta\": {\n    \"embedOptions\": {}\n  },\n  \"width\": 230\n}"}, "type": "data"}]}, {"code_hash": "4980081b03e62db7b18756459cfeb381", "console": [], "id": "RGSE", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch2 id=\"analyze-barcode-qc-drops\"\u003EAnalyze barcode QC drops\u003C/h2\u003E\n\u003Cspan class=\"paragraph\"\u003EIf a barcode is dropped especially often across plates, that could indicate something problematic with that barcode such that it should be removed altogether from the library analysis.\u003C/span\u003E\n\u003Cspan class=\"paragraph\"\u003EFirst, write a YAML with this information:\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "90d6214b04b2605161131a6310164345", "console": [], "id": "Kclp", "outputs": [{"data": {"text/html": "\u003Cdiv style='display: flex;flex: 1;flex-direction: column;justify-content: flex-start;align-items: normal;flex-wrap: nowrap;gap: 0.5rem'\u003E\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003EWriting merged barcode drops to results/qc_drops/barcode_qc_drops.yml\u003C/span\u003E\u003C/span\u003E\u003C/div\u003E"}, "type": "data"}]}, {"code_hash": "4283bb493c2da0ef2b513865efece54c", "console": [], "id": "emfo", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003ENow make a plot showing how often each barcode is dropped for each reason:\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "f7e5c76d8e66907236b526dd8362b693", "console": [], "id": "Hstk", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "ebe3dc847a2a8312fa636ad564676c96", "console": [], "id": "nWHF", "outputs": [{"data": {"application/vnd.vegalite.v5+json": "{\n  \"$schema\": \"https://vega.github.io/schema/vega-lite/v5.20.1.json\",\n  \"config\": {\n    \"axis\": {\n      \"grid\": false\n    },\n    \"view\": {\n      \"continuousHeight\": 300,\n      \"continuousWidth\": 300\n    }\n  },\n  \"data\": {\n    \"name\": \"data-7befaaa7d8a8ae5c9c14a9c45785b02a\"\n  },\n  \"datasets\": {\n    \"data-7befaaa7d8a8ae5c9c14a9c45785b02a\": [\n      {\n        \"barcode\": \"AAAATGCTGGGGTATA\",\n        \"drop type\": \"barcode_serum_replicates\",\n        \"plates_where_dropped\": 1,\n        \"total_drops\": 1\n      },\n      {\n        \"barcode\": \"AAATAATGAGTTTATA\",\n        \"drop type\": \"barcode_serum_replicates\",\n        \"plates_where_dropped\": 1,\n        \"total_drops\": 1\n      },\n      {\n        \"barcode\": \"AAGATTACCAAATTAT\",\n        \"drop type\": \"barcode_serum_replicates\",\n        \"plates_where_dropped\": 1,\n        \"total_drops\": 1\n      },\n      {\n        \"barcode\": \"AATCCGAAATTTATTC\",\n        \"drop type\": \"barcode_serum_replicates\",\n        \"plates_where_dropped\": 7,\n        \"total_drops\": 12\n      },\n      {\n        \"barcode\": \"AATGATAACTTAAAAA\",\n        \"drop type\": \"barcode_serum_replicates\",\n        \"plates_where_dropped\": 5,\n        \"total_drops\": 6\n      },\n      {\n        \"barcode\": \"AATTGTGAATGCCACA\",\n        \"drop type\": \"barcode_serum_replicates\",\n        \"plates_where_dropped\": 1,\n        \"total_drops\": 1\n      },\n      {\n        \"barcode\": \"ACAAATAGTTTATAGA\",\n        \"drop type\": \"barcode_serum_replicates\",\n        \"plates_where_dropped\": 1,\n        \"total_drops\": 1\n      },\n      {\n        \"barcode\": \"ACCCCTTCAGAAGTTA\",\n        \"drop type\": \"barcode_serum_replicates\",\n        \"plates_where_dropped\": 1,\n        \"total_drops\": 1\n      },\n      {\n        \"barcode\": \"ACGCCCCCACTTCATG\",\n        \"drop type\": \"barcode_serum_replicates\",\n        \"plates_where_dropped\": 3,\n        \"total_drops\": 4\n      },\n      {\n        \"barcode\": \"ACGGCAAGTGATGAAA\",\n        \"drop type\": \"barcode_serum_replicates\",\n        \"plates_where_dropped\": 1,\n        \"total_drops\": 1\n      },\n      {\n        \"barcode\": \"AGCAGTAAATAAAATC\",\n        \"drop type\": \"barcode_serum_replicates\",\n        \"plates_where_dropped\": 5,\n        \"total_drops\": 8\n      },\n      {\n        \"barcode\": \"AGCCCGAAGAGCCCCT\",\n        \"drop type\": \"barcode_serum_replicates\",\n        \"plates_where_dropped\": 9,\n        \"total_drops\": 12\n      },\n      {\n        \"barcode\": \"AGGAAAGAAACTGGAG\",\n        \"drop type\": \"barcode_serum_replicates\",\n        \"plates_where_dropped\": 1,\n        \"total_drops\": 1\n      },\n      {\n        \"barcode\": \"AGTACTTCGTACTCCT\",\n        \"drop type\": \"barcode_serum_replicates\",\n        \"plates_where_dropped\": 4,\n        \"total_drops\": 4\n      },\n      {\n        \"barcode\": \"ATAGCATGCGATTTTA\",\n        \"drop type\": \"barcode_serum_replicates\",\n        \"plates_where_dropped\": 1,\n        \"total_drops\": 1\n      },\n      {\n        \"barcode\": \"ATTGTGAAGAATTGCT\",\n        \"drop type\": \"barcode_serum_replicates\",\n        \"plates_where_dropped\": 1,\n        \"total_drops\": 1\n      },\n      {\n        \"barcode\": \"CAAAAACTTTAATTTC\",\n        \"drop type\": \"barcode_serum_replicates\",\n        \"plates_where_dropped\": 1,\n        \"total_drops\": 1\n      },\n      {\n        \"barcode\": \"CAAGGAAACCGGTTGA\",\n        \"drop type\": \"barcode_serum_replicates\",\n        \"plates_where_dropped\": 2,\n        \"total_drops\": 3\n      },\n      {\n        \"barcode\": \"CAGTCGCATTGAACCT\",\n        \"drop type\": \"barcode_serum_replicates\",\n        \"plates_where_dropped\": 2,\n        \"total_drops\": 2\n      },\n      {\n        \"barcode\": \"CCAAATTTTAACTGTG\",\n        \"drop type\": \"barcode_serum_replicates\",\n        \"plates_where_dropped\": 1,\n        \"total_drops\": 1\n      },\n      {\n        \"barcode\": \"CCACATAGGCGTTTTT\",\n        \"drop type\": \"barcode_serum_replicates\",\n        \"plates_where_dropped\": 8,\n        \"total_drops\": 11\n      },\n      {\n        \"barcode\": \"CCAGCCACATAAAATT\",\n        \"drop type\": \"barcode_serum_replicates\",\n        \"plates_where_dropped\": 2,\n        \"total_drops\": 2\n      },\n      {\n        \"barcode\": \"CCCCAACCTATCGTAA\",\n        \"drop type\": \"barcode_serum_replicates\",\n        \"plates_where_dropped\": 2,\n        \"total_drops\": 2\n      },\n      {\n        \"barcode\": \"CCCGACAAAGCCCTCG\",\n        \"drop type\": \"barcode_serum_replicates\",\n        \"plates_where_dropped\": 13,\n        \"total_drops\": 22\n      },\n      {\n        \"barcode\": \"CGATGCACTCGTAAGT\",\n        \"drop type\": \"barcode_serum_replicates\",\n        \"plates_where_dropped\": 1,\n        \"total_drops\": 1\n      },\n      {\n        \"barcode\": \"CTCCTAATAAAAAACT\",\n        \"drop type\": \"barcode_serum_replicates\",\n        \"plates_where_dropped\": 1,\n        \"total_drops\": 1\n      },\n      {\n        \"barcode\": \"CTGAACTTGTCGATAT\",\n        \"drop type\": \"barcode_serum_replicates\",\n        \"plates_where_dropped\": 1,\n        \"total_drops\": 1\n      },\n      {\n        \"barcode\": \"GAATATAAATGGGCAT\",\n        \"drop type\": \"barcode_serum_replicates\",\n        \"plates_where_dropped\": 11,\n        \"total_drops\": 18\n      },\n      {\n        \"barcode\": \"GAGAGTACGGCACTGA\",\n        \"drop type\": \"barcode_serum_replicates\",\n        \"plates_where_dropped\": 1,\n        \"total_drops\": 1\n      },\n      {\n        \"barcode\": \"GCAGAACATAAAACTC\",\n        \"drop type\": \"barcode_serum_replicates\",\n        \"plates_where_dropped\": 1,\n        \"total_drops\": 1\n      },\n      {\n        \"barcode\": \"GCATCCTTTTCCTGTT\",\n        \"drop type\": \"barcode_serum_replicates\",\n        \"plates_where_dropped\": 5,\n        \"total_drops\": 5\n      },\n      {\n        \"barcode\": \"GGATTACACGATACCG\",\n        \"drop type\": \"barcode_serum_replicates\",\n        \"plates_where_dropped\": 1,\n        \"total_drops\": 1\n      },\n      {\n        \"barcode\": \"GGCTTGAATGATATTG\",\n        \"drop type\": \"barcode_serum_replicates\",\n        \"plates_where_dropped\": 1,\n        \"total_drops\": 1\n      },\n      {\n        \"barcode\": \"GTCATATTCGATTACA\",\n        \"drop type\": \"barcode_serum_replicates\",\n        \"plates_where_dropped\": 2,\n        \"total_drops\": 2\n      },\n      {\n        \"barcode\": \"GTCCACAACAGTTGAA\",\n        \"drop type\": \"barcode_serum_replicates\",\n        \"plates_where_dropped\": 1,\n        \"total_drops\": 1\n      },\n      {\n        \"barcode\": \"TAACCGGGGAATCATT\",\n        \"drop type\": \"barcode_serum_replicates\",\n        \"plates_where_dropped\": 2,\n        \"total_drops\": 2\n      },\n      {\n        \"barcode\": \"TATGACATTAGAAACA\",\n        \"drop type\": \"barcode_serum_replicates\",\n        \"plates_where_dropped\": 1,\n        \"total_drops\": 1\n      },\n      {\n        \"barcode\": \"TATGGCCTATAGGTTC\",\n        \"drop type\": \"barcode_serum_replicates\",\n        \"plates_where_dropped\": 1,\n        \"total_drops\": 1\n      },\n      {\n        \"barcode\": \"TATTCAACATTCTCTA\",\n        \"drop type\": \"barcode_serum_replicates\",\n        \"plates_where_dropped\": 1,\n        \"total_drops\": 1\n      },\n      {\n        \"barcode\": \"TCATTGTCAATATTGA\",\n        \"drop type\": \"barcode_serum_replicates\",\n        \"plates_where_dropped\": 2,\n        \"total_drops\": 2\n      },\n      {\n        \"barcode\": \"TCCGAAAGACCAAAAC\",\n        \"drop type\": \"barcode_serum_replicates\",\n        \"plates_where_dropped\": 1,\n        \"total_drops\": 1\n      },\n      {\n        \"barcode\": \"TGAATGATTCTCCTTT\",\n        \"drop type\": \"barcode_serum_replicates\",\n        \"plates_where_dropped\": 1,\n        \"total_drops\": 1\n      },\n      {\n        \"barcode\": \"TGGACACTTACAACAA\",\n        \"drop type\": \"barcode_serum_replicates\",\n        \"plates_where_dropped\": 2,\n        \"total_drops\": 2\n      },\n      {\n        \"barcode\": \"TGGCCTGCTTCGGAAA\",\n        \"drop type\": \"barcode_serum_replicates\",\n        \"plates_where_dropped\": 4,\n        \"total_drops\": 4\n      },\n      {\n        \"barcode\": \"TTCTATAGTACTTCTA\",\n        \"drop type\": \"barcode_serum_replicates\",\n        \"plates_where_dropped\": 1,\n        \"total_drops\": 2\n      },\n      {\n        \"barcode\": \"AAAATCATTCGACTCT\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 5,\n        \"total_drops\": 9\n      },\n      {\n        \"barcode\": \"AAAATGCTGGGGTATA\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 3,\n        \"total_drops\": 4\n      },\n      {\n        \"barcode\": \"AAACATATTGGCGTTT\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 1,\n        \"total_drops\": 1\n      },\n      {\n        \"barcode\": \"AAACTGATTAATGATG\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 2,\n        \"total_drops\": 4\n      },\n      {\n        \"barcode\": \"AAAGCCCTAGTTAAGT\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 4,\n        \"total_drops\": 5\n      },\n      {\n        \"barcode\": \"AAAGCTCTTTTCGTTC\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 2,\n        \"total_drops\": 4\n      },\n      {\n        \"barcode\": \"AAAGTGAGACCTGTAC\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 1,\n        \"total_drops\": 1\n      },\n      {\n        \"barcode\": \"AAATAATGAGTTTATA\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 2,\n        \"total_drops\": 4\n      },\n      {\n        \"barcode\": \"AAATTAAAGAGGTTAA\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 2,\n        \"total_drops\": 2\n      },\n      {\n        \"barcode\": \"AACATGTGTAAGCGGT\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 1,\n        \"total_drops\": 1\n      },\n      {\n        \"barcode\": \"AAGATGAATGTCTTAA\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 1,\n        \"total_drops\": 2\n      },\n      {\n        \"barcode\": \"AAGATTACCAAATTAT\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 4,\n        \"total_drops\": 4\n      },\n      {\n        \"barcode\": \"AATAAAATGCATGGGT\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 4,\n        \"total_drops\": 7\n      },\n      {\n        \"barcode\": \"AATCCATTAGTTCAGC\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 4,\n        \"total_drops\": 7\n      },\n      {\n        \"barcode\": \"AATCCGAAATTTATTC\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 5,\n        \"total_drops\": 17\n      },\n      {\n        \"barcode\": \"AATGAATGTATGCTAA\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 1,\n        \"total_drops\": 1\n      },\n      {\n        \"barcode\": \"AATGATAACTTAAAAA\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 1,\n        \"total_drops\": 1\n      },\n      {\n        \"barcode\": \"AATTGTGAATGCCACA\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 8,\n        \"total_drops\": 16\n      },\n      {\n        \"barcode\": \"AATTTTAGGACGCCGT\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 1,\n        \"total_drops\": 1\n      },\n      {\n        \"barcode\": \"ACAAAGTCTCGAGAAG\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 1,\n        \"total_drops\": 1\n      },\n      {\n        \"barcode\": \"ACAAATAGTTTATAGA\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 1,\n        \"total_drops\": 1\n      },\n      {\n        \"barcode\": \"ACAGTCGCAGGGAATA\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 1,\n        \"total_drops\": 1\n      },\n      {\n        \"barcode\": \"ACCCCTTCAGAAGTTA\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 8,\n        \"total_drops\": 15\n      },\n      {\n        \"barcode\": \"ACCTATTCTATTTTTC\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 1,\n        \"total_drops\": 1\n      },\n      {\n        \"barcode\": \"ACGCCCCCACTTCATG\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 3,\n        \"total_drops\": 6\n      },\n      {\n        \"barcode\": \"ACGGCAAGTGATGAAA\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 4,\n        \"total_drops\": 6\n      },\n      {\n        \"barcode\": \"ACGTAAAAAGGATATC\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 1,\n        \"total_drops\": 1\n      },\n      {\n        \"barcode\": \"ACTAAAGGCATAGTAG\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 5,\n        \"total_drops\": 9\n      },\n      {\n        \"barcode\": \"ACTAATCGCAACTAGA\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 1,\n        \"total_drops\": 1\n      },\n      {\n        \"barcode\": \"ACTACCGCTAATATGC\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 2,\n        \"total_drops\": 2\n      },\n      {\n        \"barcode\": \"ACTTAAAATCTTATAA\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 1,\n        \"total_drops\": 1\n      },\n      {\n        \"barcode\": \"ACTTAGGAAGGTAAAC\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 2,\n        \"total_drops\": 2\n      },\n      {\n        \"barcode\": \"ACTTATGCTCTTGATA\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 3,\n        \"total_drops\": 4\n      },\n      {\n        \"barcode\": \"AGAAAGCTGTTAATAC\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 3,\n        \"total_drops\": 5\n      },\n      {\n        \"barcode\": \"AGAACAATTATTGTTA\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 1,\n        \"total_drops\": 2\n      },\n      {\n        \"barcode\": \"AGACGCTTCGGCCCAA\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 1,\n        \"total_drops\": 1\n      },\n      {\n        \"barcode\": \"AGCAGTAAATAAAATC\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 6,\n        \"total_drops\": 9\n      },\n      {\n        \"barcode\": \"AGCATCACGTCAGTCT\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 2,\n        \"total_drops\": 2\n      },\n      {\n        \"barcode\": \"AGCCCGAAGAGCCCCT\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 7,\n        \"total_drops\": 19\n      },\n      {\n        \"barcode\": \"AGCCCTTAAGACATTA\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 1,\n        \"total_drops\": 1\n      },\n      {\n        \"barcode\": \"AGGAAAGAAACTGGAG\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 3,\n        \"total_drops\": 4\n      },\n      {\n        \"barcode\": \"AGTAAACATGCATTGG\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 2,\n        \"total_drops\": 2\n      },\n      {\n        \"barcode\": \"AGTACTTCGTACTCCT\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 7,\n        \"total_drops\": 10\n      },\n      {\n        \"barcode\": \"AGTCAGGAGTCATATA\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 2,\n        \"total_drops\": 3\n      },\n      {\n        \"barcode\": \"AGTCCTATCCTCAAAT\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 1,\n        \"total_drops\": 1\n      },\n      {\n        \"barcode\": \"ATAAGAGAGCATCTCT\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 1,\n        \"total_drops\": 2\n      },\n      {\n        \"barcode\": \"ATACGTATTGATATCT\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 8,\n        \"total_drops\": 21\n      },\n      {\n        \"barcode\": \"ATAGAATCGCAAATTA\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 1,\n        \"total_drops\": 1\n      },\n      {\n        \"barcode\": \"ATAGCATGCGATTTTA\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 1,\n        \"total_drops\": 1\n      },\n      {\n        \"barcode\": \"ATAGGCATGCTTACTG\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 1,\n        \"total_drops\": 1\n      },\n      {\n        \"barcode\": \"ATATCAAGACTAGATG\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 1,\n        \"total_drops\": 1\n      },\n      {\n        \"barcode\": \"ATATGTGCTAACAAAA\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 2,\n        \"total_drops\": 3\n      },\n      {\n        \"barcode\": \"ATCCCATCAACAAAAT\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 2,\n        \"total_drops\": 2\n      },\n      {\n        \"barcode\": \"ATCTAATAATTATGGT\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 1,\n        \"total_drops\": 1\n      },\n      {\n        \"barcode\": \"ATGGATATGCTATCAG\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 1,\n        \"total_drops\": 1\n      },\n      {\n        \"barcode\": \"ATTACCTAAGTGAAAT\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 2,\n        \"total_drops\": 5\n      },\n      {\n        \"barcode\": \"ATTATGGAAATAATGA\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 1,\n        \"total_drops\": 1\n      },\n      {\n        \"barcode\": \"ATTGTGAAGAATTGCT\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 1,\n        \"total_drops\": 1\n      },\n      {\n        \"barcode\": \"CAAAAACTTTAATTTC\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 1,\n        \"total_drops\": 1\n      },\n      {\n        \"barcode\": \"CAAGGAAGTCAGGATT\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 1,\n        \"total_drops\": 1\n      },\n      {\n        \"barcode\": \"CAATCCGCTTGAATAC\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 1,\n        \"total_drops\": 1\n      },\n      {\n        \"barcode\": \"CACGAGTTGGTGGGTT\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 1,\n        \"total_drops\": 2\n      },\n      {\n        \"barcode\": \"CAGAACACGATGGAAA\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 1,\n        \"total_drops\": 1\n      },\n      {\n        \"barcode\": \"CAGATATGAGAGAGCA\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 2,\n        \"total_drops\": 2\n      },\n      {\n        \"barcode\": \"CAGTCGCATTGAACCT\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 1,\n        \"total_drops\": 1\n      },\n      {\n        \"barcode\": \"CATGCAATTCAGAGGG\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 1,\n        \"total_drops\": 1\n      },\n      {\n        \"barcode\": \"CCAAATTTTAACTGTG\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 4,\n        \"total_drops\": 7\n      },\n      {\n        \"barcode\": \"CCAAGCTAGGTCGACA\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 1,\n        \"total_drops\": 1\n      },\n      {\n        \"barcode\": \"CCACATAGGCGTTTTT\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 10,\n        \"total_drops\": 19\n      },\n      {\n        \"barcode\": \"CCAGCCACATAAAATT\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 3,\n        \"total_drops\": 3\n      },\n      {\n        \"barcode\": \"CCATAACTGTATATGG\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 2,\n        \"total_drops\": 6\n      },\n      {\n        \"barcode\": \"CCCCAACCTATCGTAA\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 1,\n        \"total_drops\": 1\n      },\n      {\n        \"barcode\": \"CCCGACAAAGCCCTCG\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 5,\n        \"total_drops\": 6\n      },\n      {\n        \"barcode\": \"CCCTATCCCAGAACCT\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 2,\n        \"total_drops\": 2\n      },\n      {\n        \"barcode\": \"CCTGTTTTTAGACGAA\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 1,\n        \"total_drops\": 1\n      },\n      {\n        \"barcode\": \"CCTTGCGGTGTTTAAC\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 1,\n        \"total_drops\": 1\n      },\n      {\n        \"barcode\": \"CCTTTCTCAAAACATA\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 1,\n        \"total_drops\": 1\n      },\n      {\n        \"barcode\": \"CGAAAGAACCTACCCG\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 2,\n        \"total_drops\": 2\n      },\n      {\n        \"barcode\": \"CGATGCACTCGTAAGT\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 4,\n        \"total_drops\": 5\n      },\n      {\n        \"barcode\": \"CGCAGATATCATAGAA\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 1,\n        \"total_drops\": 1\n      },\n      {\n        \"barcode\": \"CGCATGCAATTATAAA\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 1,\n        \"total_drops\": 1\n      },\n      {\n        \"barcode\": \"CGCCTGTAAAAATTCG\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 1,\n        \"total_drops\": 2\n      },\n      {\n        \"barcode\": \"CGGCAGGATATTGCAG\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 1,\n        \"total_drops\": 1\n      },\n      {\n        \"barcode\": \"CGTTAAGTTGAAAAAA\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 4,\n        \"total_drops\": 5\n      },\n      {\n        \"barcode\": \"CTCATATTCCTATGAC\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 2,\n        \"total_drops\": 3\n      },\n      {\n        \"barcode\": \"CTCCGCGTGTACAGAT\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 1,\n        \"total_drops\": 1\n      },\n      {\n        \"barcode\": \"CTCCTAATAAAAAACT\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 3,\n        \"total_drops\": 4\n      },\n      {\n        \"barcode\": \"CTCTCTACAGTATTGA\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 1,\n        \"total_drops\": 2\n      },\n      {\n        \"barcode\": \"CTGAACTTGTCGATAT\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 3,\n        \"total_drops\": 6\n      },\n      {\n        \"barcode\": \"CTGCACTCCGTAAATT\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 2,\n        \"total_drops\": 2\n      },\n      {\n        \"barcode\": \"CTGGAATGCAACGGGT\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 1,\n        \"total_drops\": 1\n      },\n      {\n        \"barcode\": \"CTGTAAAAAGCGTTAA\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 1,\n        \"total_drops\": 1\n      },\n      {\n        \"barcode\": \"CTTCAAAGACTGATTA\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 2,\n        \"total_drops\": 3\n      },\n      {\n        \"barcode\": \"GAAAATGATCCACATT\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 2,\n        \"total_drops\": 3\n      },\n      {\n        \"barcode\": \"GAATATAAATGGGCAT\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 10,\n        \"total_drops\": 30\n      },\n      {\n        \"barcode\": \"GACAATATACCCCCAT\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 5,\n        \"total_drops\": 10\n      },\n      {\n        \"barcode\": \"GACACAGAACCCATGC\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 2,\n        \"total_drops\": 2\n      },\n      {\n        \"barcode\": \"GAGAGTACGGCACTGA\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 1,\n        \"total_drops\": 1\n      },\n      {\n        \"barcode\": \"GATAATAGAAAGTGTA\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 1,\n        \"total_drops\": 1\n      },\n      {\n        \"barcode\": \"GCAGAACATAAAACTC\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 7,\n        \"total_drops\": 9\n      },\n      {\n        \"barcode\": \"GCATCCTTTTCCTGTT\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 10,\n        \"total_drops\": 15\n      },\n      {\n        \"barcode\": \"GCCTTGCATTAGGAAC\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 1,\n        \"total_drops\": 1\n      },\n      {\n        \"barcode\": \"GCGGTATTCATTAATA\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 1,\n        \"total_drops\": 1\n      },\n      {\n        \"barcode\": \"GGACATCTTTCAAGCA\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 1,\n        \"total_drops\": 1\n      },\n      {\n        \"barcode\": \"GGATTACACGATACCG\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 1,\n        \"total_drops\": 1\n      },\n      {\n        \"barcode\": \"GGATTGTAATAAATCA\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 5,\n        \"total_drops\": 6\n      },\n      {\n        \"barcode\": \"GGCTTGAATGATATTG\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 3,\n        \"total_drops\": 6\n      },\n      {\n        \"barcode\": \"GTAAAGACCTTCGGAG\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 2,\n        \"total_drops\": 3\n      },\n      {\n        \"barcode\": \"GTAATACTGATGGGCA\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 1,\n        \"total_drops\": 2\n      },\n      {\n        \"barcode\": \"GTAGAAATCATAGGCG\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 1,\n        \"total_drops\": 1\n      },\n      {\n        \"barcode\": \"GTATCCCCACGAAAGT\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 2,\n        \"total_drops\": 5\n      },\n      {\n        \"barcode\": \"GTCAAATAAATTTTCA\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 3,\n        \"total_drops\": 5\n      },\n      {\n        \"barcode\": \"GTCACTATATGATGTC\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 1,\n        \"total_drops\": 1\n      },\n      {\n        \"barcode\": \"GTCATATTCGATTACA\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 2,\n        \"total_drops\": 2\n      },\n      {\n        \"barcode\": \"GTCCACAACAGTTGAA\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 2,\n        \"total_drops\": 3\n      },\n      {\n        \"barcode\": \"GTCTAACAAGAATGTA\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 1,\n        \"total_drops\": 1\n      },\n      {\n        \"barcode\": \"GTTTCTGCCTTACAAA\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 2,\n        \"total_drops\": 2\n      },\n      {\n        \"barcode\": \"TAAAGACAAAAAAACC\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 1,\n        \"total_drops\": 1\n      },\n      {\n        \"barcode\": \"TAACAGTTAGACAAAA\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 2,\n        \"total_drops\": 2\n      },\n      {\n        \"barcode\": \"TAACCGCTTCAATATA\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 2,\n        \"total_drops\": 2\n      },\n      {\n        \"barcode\": \"TAACCGGGGAATCATT\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 1,\n        \"total_drops\": 1\n      },\n      {\n        \"barcode\": \"TAATAAGCCAGCAAGA\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 1,\n        \"total_drops\": 1\n      },\n      {\n        \"barcode\": \"TACTAAGTAAGAGCAA\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 2,\n        \"total_drops\": 2\n      },\n      {\n        \"barcode\": \"TAGGACTACAGAGAAC\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 3,\n        \"total_drops\": 8\n      },\n      {\n        \"barcode\": \"TAGTAATCTAAAGTAA\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 2,\n        \"total_drops\": 4\n      },\n      {\n        \"barcode\": \"TAGTTGACTGTCGAGG\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 2,\n        \"total_drops\": 2\n      },\n      {\n        \"barcode\": \"TATGACATTAGAAACA\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 2,\n        \"total_drops\": 3\n      },\n      {\n        \"barcode\": \"TATGGCCTATAGGTTC\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 4,\n        \"total_drops\": 5\n      },\n      {\n        \"barcode\": \"TATTCAACATTCTCTA\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 1,\n        \"total_drops\": 2\n      },\n      {\n        \"barcode\": \"TCACAATTCATATAAT\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 1,\n        \"total_drops\": 2\n      },\n      {\n        \"barcode\": \"TCATTGTCAATATTGA\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 4,\n        \"total_drops\": 4\n      },\n      {\n        \"barcode\": \"TCCGAAAGACCAAAAC\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 11,\n        \"total_drops\": 26\n      },\n      {\n        \"barcode\": \"TCGACGCTTCATGGAA\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 1,\n        \"total_drops\": 1\n      },\n      {\n        \"barcode\": \"TCTATCATCGCCGTTA\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 4,\n        \"total_drops\": 6\n      },\n      {\n        \"barcode\": \"TGAACTAGACTTTCAA\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 1,\n        \"total_drops\": 2\n      },\n      {\n        \"barcode\": \"TGAAGCCATGAGTATC\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 5,\n        \"total_drops\": 8\n      },\n      {\n        \"barcode\": \"TGAATGATTCTCCTTT\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 1,\n        \"total_drops\": 1\n      },\n      {\n        \"barcode\": \"TGCATTAATTCAACTA\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 1,\n        \"total_drops\": 1\n      },\n      {\n        \"barcode\": \"TGCCATCTGTGCATTA\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 1,\n        \"total_drops\": 1\n      },\n      {\n        \"barcode\": \"TGGAATCGTCACCGAT\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 1,\n        \"total_drops\": 1\n      },\n      {\n        \"barcode\": \"TGGACACTTACAACAA\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 4,\n        \"total_drops\": 6\n      },\n      {\n        \"barcode\": \"TGGCCTGCTTCGGAAA\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 2,\n        \"total_drops\": 4\n      },\n      {\n        \"barcode\": \"TGGGAAATCATTGGTA\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 3,\n        \"total_drops\": 7\n      },\n      {\n        \"barcode\": \"TGTGATAGACCTAGAA\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 5,\n        \"total_drops\": 8\n      },\n      {\n        \"barcode\": \"TGTTTTACATTAGATG\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 2,\n        \"total_drops\": 2\n      },\n      {\n        \"barcode\": \"TTACCTCTGAGAAACG\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 1,\n        \"total_drops\": 1\n      },\n      {\n        \"barcode\": \"TTATAAAAACAAATCG\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 1,\n        \"total_drops\": 2\n      },\n      {\n        \"barcode\": \"TTCTATAGTACTTCTA\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 4,\n        \"total_drops\": 5\n      },\n      {\n        \"barcode\": \"TTCTATGTTTCTTTAA\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 1,\n        \"total_drops\": 2\n      },\n      {\n        \"barcode\": \"TTGAAAAAATCATAAA\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 1,\n        \"total_drops\": 1\n      },\n      {\n        \"barcode\": \"TTGGGCACTAAATTAA\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 1,\n        \"total_drops\": 1\n      },\n      {\n        \"barcode\": \"TTTTAGATAAACTTAG\",\n        \"drop type\": \"barcode_wells\",\n        \"plates_where_dropped\": 1,\n        \"total_drops\": 3\n      },\n      {\n        \"barcode\": \"AAAATCATTCGACTCT\",\n        \"drop type\": \"barcodes\",\n        \"plates_where_dropped\": 11,\n        \"total_drops\": 11\n      },\n      {\n        \"barcode\": \"AATCCGAAATTTATTC\",\n        \"drop type\": \"barcodes\",\n        \"plates_where_dropped\": 9,\n        \"total_drops\": 9\n      },\n      {\n        \"barcode\": \"CCAGGAACAATATATC\",\n        \"drop type\": \"barcodes\",\n        \"plates_where_dropped\": 21,\n        \"total_drops\": 21\n      },\n      {\n        \"barcode\": \"CCCACCCCTGCCTCCC\",\n        \"drop type\": \"barcodes\",\n        \"plates_where_dropped\": 21,\n        \"total_drops\": 21\n      },\n      {\n        \"barcode\": \"GAGCAGTATCTGGTTA\",\n        \"drop type\": \"barcodes\",\n        \"plates_where_dropped\": 21,\n        \"total_drops\": 21\n      },\n      {\n        \"barcode\": \"TTGAAAGCCACAACAC\",\n        \"drop type\": \"barcodes\",\n        \"plates_where_dropped\": 21,\n        \"total_drops\": 21\n      }\n    ]\n  },\n  \"encoding\": {\n    \"column\": {\n      \"field\": \"drop type\",\n      \"header\": {\n        \"labelFontSize\": 12,\n        \"labelFontStyle\": \"bold\",\n        \"labelPadding\": 1\n      },\n      \"spacing\": 8,\n      \"title\": null,\n      \"type\": \"nominal\"\n    },\n    \"strokeWidth\": {\n      \"condition\": {\n        \"empty\": false,\n        \"param\": \"param_2\",\n        \"value\": 3\n      },\n      \"value\": 0.5\n    },\n    \"tooltip\": [\n      {\n        \"field\": \"drop type\",\n        \"type\": \"nominal\"\n      },\n      {\n        \"field\": \"barcode\",\n        \"type\": \"nominal\"\n      },\n      {\n        \"field\": \"plates_where_dropped\",\n        \"type\": \"quantitative\"\n      },\n      {\n        \"field\": \"total_drops\",\n        \"type\": \"quantitative\"\n      }\n    ],\n    \"x\": {\n      \"field\": \"total_drops\",\n      \"title\": \"times barcode dropped\",\n      \"type\": \"quantitative\"\n    },\n    \"y\": {\n      \"axis\": {\n        \"labelFontSize\": 9\n      },\n      \"field\": \"barcode\",\n      \"sort\": {\n        \"field\": \"total_drops\",\n        \"order\": \"descending\"\n      },\n      \"type\": \"nominal\"\n    }\n  },\n  \"height\": {\n    \"step\": 10\n  },\n  \"mark\": {\n    \"height\": {\n      \"band\": 0.8\n    },\n    \"stroke\": \"black\",\n    \"type\": \"bar\"\n  },\n  \"params\": [\n    {\n      \"name\": \"param_2\",\n      \"select\": {\n        \"fields\": [\n          \"barcode\"\n        ],\n        \"on\": \"mouseover\",\n        \"type\": \"point\"\n      }\n    }\n  ],\n  \"resolve\": {\n    \"scale\": {\n      \"color\": \"independent\",\n      \"x\": \"independent\",\n      \"y\": \"independent\"\n    }\n  },\n  \"title\": {\n    \"anchor\": \"middle\",\n    \"dy\": -2,\n    \"text\": \"Number of QC drops when processing plates\"\n  },\n  \"usermeta\": {\n    \"embedOptions\": {}\n  },\n  \"width\": 200\n}"}, "type": "data"}]}, {"code_hash": "6340fb0951d5247ae104fa96d223d19d", "console": [], "id": "iLit", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch2 id=\"analyze-the-groupssera-qc\"\u003EAnalyze the groups/sera QC\u003C/h2\u003E\n\u003Cspan class=\"paragraph\"\u003EAnalyze the QC performed on the groups/sera, which involves completely dropping titers for certain virus-sera pairs.\u003C/span\u003E\n\u003Cspan class=\"paragraph\"\u003ERead the QC for different groups/sera into a merged dictionary, write it to YAML, and also convert to a DataFrame.\nIf you really want to look into the details of what is being dropped, you will want to look at that merged YAML file.\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "85058d1ff301ce203056551a79d58a49", "console": [], "id": "ZHCJ", "outputs": [{"data": {"text/html": "\u003Cdiv style='display: flex;flex: 1;flex-direction: column;justify-content: flex-start;align-items: normal;flex-wrap: nowrap;gap: 0.5rem'\u003E\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003EWriting merged groups/sera drops to results/qc_drops/groups_sera_qc_drops.yml\u003C/span\u003E\u003C/span\u003E\u003C/div\u003E"}, "type": "data"}]}, {"code_hash": "687a69572c791df824768b8528d5f4c4", "console": [], "id": "ROlb", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003EPlot the number of viruses dropped for each group/serum.\nIf a group/serum has many missed viruses, then you will lack a lot of titers and so it may be worth reviewing the cause of the drops.\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "17f4c05e98a5147dcc1d6035d20fb9af", "console": [{"mimetype": "text/plain", "name": "stderr", "text": "/fh/fast/bloom_j/computational_notebooks/aloes/2026/250107_testrepo/flu_seqneut_pdmH1N1_2023-2024_VaccinatedCohorts/.snakemake/conda/069147b3e767baddb6940739b7bde205_/lib/python3.13/site-packages/altair/utils/core.py:264: UserWarning: I don't know how to infer vegalite type from 'empty'.  Defaulting to nominal.\n  warnings.warn(\n/fh/fast/bloom_j/computational_notebooks/aloes/2026/250107_testrepo/flu_seqneut_pdmH1N1_2023-2024_VaccinatedCohorts/.snakemake/conda/069147b3e767baddb6940739b7bde205_/lib/python3.13/site-packages/altair/utils/core.py:264: UserWarning: I don't know how to infer vegalite type from 'empty'.  Defaulting to nominal.\n  warnings.warn(\n/fh/fast/bloom_j/computational_notebooks/aloes/2026/250107_testrepo/flu_seqneut_pdmH1N1_2023-2024_VaccinatedCohorts/.snakemake/conda/069147b3e767baddb6940739b7bde205_/lib/python3.13/site-packages/altair/utils/core.py:264: UserWarning: I don't know how to infer vegalite type from 'empty'.  Defaulting to nominal.\n  warnings.warn(\n/fh/fast/bloom_j/computational_notebooks/aloes/2026/250107_testrepo/flu_seqneut_pdmH1N1_2023-2024_VaccinatedCohorts/.snakemake/conda/069147b3e767baddb6940739b7bde205_/lib/python3.13/site-packages/altair/utils/core.py:264: UserWarning: I don't know how to infer vegalite type from 'empty'.  Defaulting to nominal.\n  warnings.warn(\n/fh/fast/bloom_j/computational_notebooks/aloes/2026/250107_testrepo/flu_seqneut_pdmH1N1_2023-2024_VaccinatedCohorts/.snakemake/conda/069147b3e767baddb6940739b7bde205_/lib/python3.13/site-packages/altair/utils/core.py:264: UserWarning: I don't know how to infer vegalite type from 'empty'.  Defaulting to nominal.\n  warnings.warn(\n/fh/fast/bloom_j/computational_notebooks/aloes/2026/250107_testrepo/flu_seqneut_pdmH1N1_2023-2024_VaccinatedCohorts/.snakemake/conda/069147b3e767baddb6940739b7bde205_/lib/python3.13/site-packages/altair/utils/core.py:264: UserWarning: I don't know how to infer vegalite type from 'empty'.  Defaulting to nominal.\n  warnings.warn(\n/fh/fast/bloom_j/computational_notebooks/aloes/2026/250107_testrepo/flu_seqneut_pdmH1N1_2023-2024_VaccinatedCohorts/.snakemake/conda/069147b3e767baddb6940739b7bde205_/lib/python3.13/site-packages/altair/utils/core.py:264: UserWarning: I don't know how to infer vegalite type from 'empty'.  Defaulting to nominal.\n  warnings.warn(\n/fh/fast/bloom_j/computational_notebooks/aloes/2026/250107_testrepo/flu_seqneut_pdmH1N1_2023-2024_VaccinatedCohorts/.snakemake/conda/069147b3e767baddb6940739b7bde205_/lib/python3.13/site-packages/altair/utils/core.py:264: UserWarning: I don't know how to infer vegalite type from 'empty'.  Defaulting to nominal.\n  warnings.warn(\n/fh/fast/bloom_j/computational_notebooks/aloes/2026/250107_testrepo/flu_seqneut_pdmH1N1_2023-2024_VaccinatedCohorts/.snakemake/conda/069147b3e767baddb6940739b7bde205_/lib/python3.13/site-packages/altair/utils/core.py:264: UserWarning: I don't know how to infer vegalite type from 'empty'.  Defaulting to nominal.\n  warnings.warn(\n/fh/fast/bloom_j/computational_notebooks/aloes/2026/250107_testrepo/flu_seqneut_pdmH1N1_2023-2024_VaccinatedCohorts/.snakemake/conda/069147b3e767baddb6940739b7bde205_/lib/python3.13/site-packages/altair/utils/core.py:264: UserWarning: I don't know how to infer vegalite type from 'empty'.  Defaulting to nominal.\n  warnings.warn(\n/fh/fast/bloom_j/computational_notebooks/aloes/2026/250107_testrepo/flu_seqneut_pdmH1N1_2023-2024_VaccinatedCohorts/.snakemake/conda/069147b3e767baddb6940739b7bde205_/lib/python3.13/site-packages/altair/utils/core.py:264: UserWarning: I don't know how to infer vegalite type from 'empty'.  Defaulting to nominal.\n  warnings.warn(\n/fh/fast/bloom_j/computational_notebooks/aloes/2026/250107_testrepo/flu_seqneut_pdmH1N1_2023-2024_VaccinatedCohorts/.snakemake/conda/069147b3e767baddb6940739b7bde205_/lib/python3.13/site-packages/altair/utils/core.py:264: UserWarning: I don't know how to infer vegalite type from 'empty'.  Defaulting to nominal.\n  warnings.warn(\n", "type": "stream"}], "id": "qnkX", "outputs": [{"data": {"application/vnd.vegalite.v5+json": "{\n  \"$schema\": \"https://vega.github.io/schema/vega-lite/v5.20.1.json\",\n  \"config\": {\n    \"axis\": {\n      \"grid\": false\n    },\n    \"view\": {\n      \"continuousHeight\": 300,\n      \"continuousWidth\": 300\n    }\n  },\n  \"data\": {\n    \"name\": \"data-4f53cda18c2baa0c0354bb5f9a3ecbe5\"\n  },\n  \"datasets\": {\n    \"data-4f53cda18c2baa0c0354bb5f9a3ecbe5\": []\n  },\n  \"encoding\": {\n    \"color\": {\n      \"field\": \"reason\",\n      \"legend\": {\n        \"labelLimit\": 350\n      },\n      \"title\": \"reason dropped\",\n      \"type\": \"nominal\"\n    },\n    \"row\": {\n      \"field\": \"group\",\n      \"type\": \"nominal\"\n    },\n    \"tooltip\": [\n      {\n        \"field\": \"group\",\n        \"type\": \"nominal\"\n      },\n      {\n        \"field\": \"serum\",\n        \"type\": \"nominal\"\n      },\n      {\n        \"field\": \"reason\",\n        \"type\": \"nominal\"\n      },\n      {\n        \"field\": \"n_viruses\",\n        \"type\": \"quantitative\"\n      }\n    ],\n    \"x\": {\n      \"field\": \"n_viruses\",\n      \"title\": \"number of viruses dropped\",\n      \"type\": \"quantitative\"\n    },\n    \"y\": {\n      \"field\": \"serum\",\n      \"type\": \"nominal\"\n    }\n  },\n  \"height\": {\n    \"step\": 13\n  },\n  \"mark\": {\n    \"height\": {\n      \"band\": 0.8\n    },\n    \"type\": \"bar\"\n  },\n  \"resolve\": {\n    \"scale\": {\n      \"x\": \"independent\",\n      \"y\": \"independent\"\n    }\n  },\n  \"title\": \"Number of viruses dropped at serum QC for each serum\",\n  \"usermeta\": {\n    \"embedOptions\": {}\n  },\n  \"width\": 250\n}"}, "type": "data"}]}, {"code_hash": "42d07d5e3b31d72117bb92979e93979b", "console": [], "id": "TqIu", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003EPlot the number of sera for which each virus is dropped during serum QC.\nIf a virus is dropped for many sera, that may indicate some issue with that virus in assays:\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "baf992685b9dcb85555216d8f7daac5e", "console": [{"mimetype": "text/plain", "name": "stderr", "text": "/fh/fast/bloom_j/computational_notebooks/aloes/2026/250107_testrepo/flu_seqneut_pdmH1N1_2023-2024_VaccinatedCohorts/.snakemake/conda/069147b3e767baddb6940739b7bde205_/lib/python3.13/site-packages/altair/utils/core.py:264: UserWarning: I don't know how to infer vegalite type from 'empty'.  Defaulting to nominal.\n  warnings.warn(\n/fh/fast/bloom_j/computational_notebooks/aloes/2026/250107_testrepo/flu_seqneut_pdmH1N1_2023-2024_VaccinatedCohorts/.snakemake/conda/069147b3e767baddb6940739b7bde205_/lib/python3.13/site-packages/altair/utils/core.py:264: UserWarning: I don't know how to infer vegalite type from 'empty'.  Defaulting to nominal.\n  warnings.warn(\n/fh/fast/bloom_j/computational_notebooks/aloes/2026/250107_testrepo/flu_seqneut_pdmH1N1_2023-2024_VaccinatedCohorts/.snakemake/conda/069147b3e767baddb6940739b7bde205_/lib/python3.13/site-packages/altair/utils/core.py:264: UserWarning: I don't know how to infer vegalite type from 'empty'.  Defaulting to nominal.\n  warnings.warn(\n/fh/fast/bloom_j/computational_notebooks/aloes/2026/250107_testrepo/flu_seqneut_pdmH1N1_2023-2024_VaccinatedCohorts/.snakemake/conda/069147b3e767baddb6940739b7bde205_/lib/python3.13/site-packages/altair/utils/core.py:264: UserWarning: I don't know how to infer vegalite type from 'empty'.  Defaulting to nominal.\n  warnings.warn(\n/fh/fast/bloom_j/computational_notebooks/aloes/2026/250107_testrepo/flu_seqneut_pdmH1N1_2023-2024_VaccinatedCohorts/.snakemake/conda/069147b3e767baddb6940739b7bde205_/lib/python3.13/site-packages/altair/utils/core.py:264: UserWarning: I don't know how to infer vegalite type from 'empty'.  Defaulting to nominal.\n  warnings.warn(\n/fh/fast/bloom_j/computational_notebooks/aloes/2026/250107_testrepo/flu_seqneut_pdmH1N1_2023-2024_VaccinatedCohorts/.snakemake/conda/069147b3e767baddb6940739b7bde205_/lib/python3.13/site-packages/altair/utils/core.py:264: UserWarning: I don't know how to infer vegalite type from 'empty'.  Defaulting to nominal.\n  warnings.warn(\n/fh/fast/bloom_j/computational_notebooks/aloes/2026/250107_testrepo/flu_seqneut_pdmH1N1_2023-2024_VaccinatedCohorts/.snakemake/conda/069147b3e767baddb6940739b7bde205_/lib/python3.13/site-packages/altair/utils/core.py:264: UserWarning: I don't know how to infer vegalite type from 'empty'.  Defaulting to nominal.\n  warnings.warn(\n/fh/fast/bloom_j/computational_notebooks/aloes/2026/250107_testrepo/flu_seqneut_pdmH1N1_2023-2024_VaccinatedCohorts/.snakemake/conda/069147b3e767baddb6940739b7bde205_/lib/python3.13/site-packages/altair/utils/core.py:264: UserWarning: I don't know how to infer vegalite type from 'empty'.  Defaulting to nominal.\n  warnings.warn(\n/fh/fast/bloom_j/computational_notebooks/aloes/2026/250107_testrepo/flu_seqneut_pdmH1N1_2023-2024_VaccinatedCohorts/.snakemake/conda/069147b3e767baddb6940739b7bde205_/lib/python3.13/site-packages/altair/utils/core.py:264: UserWarning: I don't know how to infer vegalite type from 'empty'.  Defaulting to nominal.\n  warnings.warn(\n/fh/fast/bloom_j/computational_notebooks/aloes/2026/250107_testrepo/flu_seqneut_pdmH1N1_2023-2024_VaccinatedCohorts/.snakemake/conda/069147b3e767baddb6940739b7bde205_/lib/python3.13/site-packages/altair/utils/core.py:264: UserWarning: I don't know how to infer vegalite type from 'empty'.  Defaulting to nominal.\n  warnings.warn(\n/fh/fast/bloom_j/computational_notebooks/aloes/2026/250107_testrepo/flu_seqneut_pdmH1N1_2023-2024_VaccinatedCohorts/.snakemake/conda/069147b3e767baddb6940739b7bde205_/lib/python3.13/site-packages/altair/utils/core.py:264: UserWarning: I don't know how to infer vegalite type from 'empty'.  Defaulting to nominal.\n  warnings.warn(\n/fh/fast/bloom_j/computational_notebooks/aloes/2026/250107_testrepo/flu_seqneut_pdmH1N1_2023-2024_VaccinatedCohorts/.snakemake/conda/069147b3e767baddb6940739b7bde205_/lib/python3.13/site-packages/altair/utils/core.py:264: UserWarning: I don't know how to infer vegalite type from 'empty'.  Defaulting to nominal.\n  warnings.warn(\n", "type": "stream"}], "id": "Vxnm", "outputs": [{"data": {"application/vnd.vegalite.v5+json": "{\n  \"$schema\": \"https://vega.github.io/schema/vega-lite/v5.20.1.json\",\n  \"config\": {\n    \"axis\": {\n      \"grid\": false\n    },\n    \"view\": {\n      \"continuousHeight\": 300,\n      \"continuousWidth\": 300\n    }\n  },\n  \"data\": {\n    \"name\": \"data-4f53cda18c2baa0c0354bb5f9a3ecbe5\"\n  },\n  \"datasets\": {\n    \"data-4f53cda18c2baa0c0354bb5f9a3ecbe5\": []\n  },\n  \"encoding\": {\n    \"color\": {\n      \"field\": \"reason\",\n      \"legend\": {\n        \"labelLimit\": 350\n      },\n      \"title\": \"reason dropped\",\n      \"type\": \"nominal\"\n    },\n    \"row\": {\n      \"field\": \"group\",\n      \"type\": \"nominal\"\n    },\n    \"tooltip\": [\n      {\n        \"field\": \"group\",\n        \"type\": \"nominal\"\n      },\n      {\n        \"field\": \"virus\",\n        \"type\": \"nominal\"\n      },\n      {\n        \"field\": \"reason\",\n        \"type\": \"nominal\"\n      },\n      {\n        \"field\": \"n_sera\",\n        \"type\": \"quantitative\"\n      }\n    ],\n    \"x\": {\n      \"field\": \"n_sera\",\n      \"title\": \"number of sera for which virus is dropped\",\n      \"type\": \"quantitative\"\n    },\n    \"y\": {\n      \"field\": \"virus\",\n      \"sort\": {\n        \"field\": \"n_sera\",\n        \"order\": \"descending\"\n      },\n      \"type\": \"nominal\"\n    }\n  },\n  \"height\": {\n    \"step\": 13\n  },\n  \"mark\": {\n    \"height\": {\n      \"band\": 0.8\n    },\n    \"type\": \"bar\"\n  },\n  \"resolve\": {\n    \"scale\": {\n      \"x\": \"independent\",\n      \"y\": \"independent\"\n    }\n  },\n  \"title\": \"Number of sera for which each virus is dropped at serum QC\",\n  \"usermeta\": {\n    \"embedOptions\": {}\n  },\n  \"width\": 250\n}"}, "type": "data"}]}], "metadata": {"marimo_version": "0.17.6"}, "version": "1"},
            "runtimeConfig": null,
        };
    </script>
  
<marimo-code hidden="">
    import%20marimo%0A%0A__generated_with%20%3D%20%220.17.6%22%0Aapp%20%3D%20marimo.App(width%3D%22full%22)%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20%23%20Load%20context%20from%20pickled%20file.%0A%20%20%20%20%23%0A%20%20%20%20%23%20This%20cell%20supports%20multiple%20ways%20to%20provide%20context%3A%0A%20%20%20%20%23%201.%20Via%20command-line%3A%20marimo%20export%20html%20notebook.py%20--%20--context-pickle%20path%2Fto%2Fcontext.pickle%0A%20%20%20%20%23%202.%20Via%20saved%20pickle%3A%20Manually%20save%20a%20context%20pickle%20to%20test_example%2Fresults%2Fcontext_dev.pickle%0A%20%20%20%20%23%203.%20Stub%20context%3A%20If%20no%20pickle%20available%2C%20creates%20minimal%20empty%20context%20for%20exploration%0A%20%20%20%20%23%0A%20%20%20%20%23%20For%20interactive%20development%20with%20%60marimo%20edit%60%2C%20you%20can%3A%0A%20%20%20%20%23%20-%20Run%20the%20pipeline%20once%20to%20generate%20a%20real%20context%20pickle%2C%20then%20copy%20it%20to%20context_dev.pickle%0A%20%20%20%20%23%20-%20Or%20work%20with%20the%20stub%20context%20(downstream%20cells%20will%20show%20warnings%2Fempty%20data)%0A%0A%20%20%20%20import%20argparse%0A%20%20%20%20import%20os%0A%20%20%20%20import%20pathlib%0A%20%20%20%20import%20pickle%0A%20%20%20%20import%20sys%0A%0A%20%20%20%20import%20marimo%20as%20mo%0A%0A%20%20%20%20%23%20Check%20if%20context-pickle%20argument%20is%20provided%20(run%20by%20driver%20script)%0A%20%20%20%20from_cmdline%20%3D%20%22--context-pickle%22%20in%20sys.argv%0A%0A%20%20%20%20if%20from_cmdline%3A%0A%20%20%20%20%20%20%20%20%23%20Running%20via%20driver%20script%20-%20parse%20args%0A%20%20%20%20%20%20%20%20print(%22Loading%20context%20from%20command-line%20argument%22)%0A%20%20%20%20%20%20%20%20p%20%3D%20argparse.ArgumentParser()%0A%20%20%20%20%20%20%20%20p.add_argument(%22--context-pickle%22%2C%20required%3DTrue)%0A%20%20%20%20%20%20%20%20args%20%3D%20p.parse_args()%0A%20%20%20%20%20%20%20%20context_pickle_path%20%3D%20pathlib.Path(args.context_pickle)%0A%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%23%20Running%20in%20marimo%20edit%20-%20try%20to%20use%20development%20pickle%0A%20%20%20%20%20%20%20%20print(%22Running%20in%20marimo%20edit%20mode%22)%0A%20%20%20%20%20%20%20%20%23%20set%20%60context_pickle_path%60%20to%20valid%20pickle%20if%20running%20via%20marimo%20edit%0A%20%20%20%20%20%20%20%20context_pickle_path%20%3D%20None%0A%20%20%20%20%20%20%20%20%23%20context_pickle_path%20%3D%20pathlib.Path(%22test_example%2Fresults%2Fqc_drops%2Faggregate_qc_drops_context.pickle%22)%0A%0A%20%20%20%20%23%20Load%20context%20if%20pickle%20path%20exists%20and%20is%20valid%0A%20%20%20%20if%20context_pickle_path%20and%20context_pickle_path.exists()%3A%0A%20%20%20%20%20%20%20%20print(f%22Reading%20context%20from%20%7Bcontext_pickle_path%7D%22)%0A%20%20%20%20%20%20%20%20with%20open(context_pickle_path%2C%20%22rb%22)%20as%20f_context%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20context%20%3D%20pickle.load(f_context)%0A%0A%20%20%20%20%20%20%20%20%23%20Handle%20working%20directory%0A%20%20%20%20%20%20%20%20context_workdir%20%3D%20context%5B%22workdir%22%5D%0A%20%20%20%20%20%20%20%20current_workdir%20%3D%20os.getcwd()%0A%0A%20%20%20%20%20%20%20%20if%20from_cmdline%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20Running%20via%20snakemake%20-%20verify%20workdir%20matches%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20context_workdir%20!%3D%20current_workdir%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20raise%20RuntimeError(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20f%22Context%20workdir%20mismatch!%5Cn%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20f%22%20%20Context%20was%20created%20in%3A%20%7Bcontext_workdir%7D%5Cn%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20f%22%20%20Currently%20running%20in%3A%20%20%20%7Bcurrent_workdir%7D%5Cn%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20f%22This%20should%20not%20happen%20when%20running%20via%20Snakemake.%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20%20%20%20%20print(f%22Verified%20working%20directory%3A%20%7Bcurrent_workdir%7D%22)%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20Running%20in%20marimo%20edit%20-%20change%20to%20context%20workdir%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20context_workdir%20and%20context_workdir%20!%3D%20current_workdir%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20print(f%22Changing%20directory%20from%20%7Bcurrent_workdir%7D%20to%20%7Bcontext_workdir%7D%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20os.chdir(context_workdir)%0A%20%20%20%20%20%20%20%20%20%20%20%20elif%20context_workdir%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20print(f%22Already%20in%20correct%20working%20directory%3A%20%7Bcontext_workdir%7D%22)%0A%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%23%20Create%20a%20minimal%20stub%20context%20for%20interactive%20development%0A%20%20%20%20%20%20%20%20print(%22Creating%20minimal%20stub%20context%20that%20you%20need%20to%20complete%22)%0A%20%20%20%20%20%20%20%20context%20%3D%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%22input%22%3A%20%7B%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22output%22%3A%20%7B%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22params%22%3A%20%7B%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22wildcards%22%3A%20%7B%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22threads%22%3A%201%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22resources%22%3A%20%7B%7D%2C%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20return%20context%2C%20mo%0A%0A%0A%40app.cell%0Adef%20_(context%2C%20mo)%3A%0A%20%20%20%20%23%20Extract%20variables%20from%20context%20-%20raises%20KeyError%20if%20required%20keys%20missing%0A%20%20%20%20input_plate_qc_drops%20%3D%20context%5B%22input%22%5D%5B%22plate_qc_drops%22%5D%0A%20%20%20%20input_groups_sera_qc_drops%20%3D%20context%5B%22input%22%5D%5B%22groups_sera_qc_drops%22%5D%0A%20%20%20%20output_plate_qc_drops%20%3D%20context%5B%22output%22%5D%5B%22plate_qc_drops%22%5D%0A%20%20%20%20output_barcode_qc_drops%20%3D%20context%5B%22output%22%5D%5B%22barcode_qc_drops%22%5D%0A%20%20%20%20output_groups_sera_qc_drops%20%3D%20context%5B%22output%22%5D%5B%22groups_sera_qc_drops%22%5D%0A%20%20%20%20plates%20%3D%20context%5B%22params%22%5D%5B%22plates%22%5D%0A%20%20%20%20groups_sera%20%3D%20context%5B%22params%22%5D%5B%22groups_sera%22%5D%0A%0A%20%20%20%20%23%20Show%20informative%20message%20about%20context%20mode%0A%20%20%20%20if%20not%20context%5B%22input%22%5D%3A%0A%20%20%20%20%20%20%20%20mo.output.append(%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.callout(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22**%E2%9A%A0%EF%B8%8F%20Running%20in%20interactive%20mode%20with%20stub%20context**%5Cn%5Cn%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22To%20run%20with%20real%20data%3A%5Cn%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%221.%20Run%20the%20pipeline%20to%20generate%20a%20context%20pickle%5Cn%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%222.%20Copy%20it%20to%20%60test_example%2Fresults%2Fcontext_dev.pickle%60%5Cn%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%223.%20Or%20run%3A%20%60marimo%20export%20html%20notebook.py%20--%20--context-pickle%20path%2Fto%2Fcontext.pickle%60%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20kind%3D%22warn%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20return%20(%0A%20%20%20%20%20%20%20%20groups_sera%2C%0A%20%20%20%20%20%20%20%20input_groups_sera_qc_drops%2C%0A%20%20%20%20%20%20%20%20input_plate_qc_drops%2C%0A%20%20%20%20%20%20%20%20output_barcode_qc_drops%2C%0A%20%20%20%20%20%20%20%20output_groups_sera_qc_drops%2C%0A%20%20%20%20%20%20%20%20output_plate_qc_drops%2C%0A%20%20%20%20%20%20%20%20plates%2C%0A%20%20%20%20)%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%20Aggregate%20and%20analyze%20the%20drops%20from%20QC-ing%20the%20plates%20and%20sera%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20import%20altair%20as%20alt%0A%0A%20%20%20%20import%20pandas%20as%20pd%0A%0A%20%20%20%20from%20ruamel.yaml%20import%20YAML%0A%0A%20%20%20%20yaml%20%3D%20YAML(typ%3D%22rt%22)%0A%0A%20%20%20%20_%20%3D%20alt.data_transformers.disable_max_rows()%0A%20%20%20%20return%20alt%2C%20pd%2C%20yaml%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%23%20Analyze%20plate%20QC%20drops%0A%20%20%20%20Read%20QC%20drops%20for%20individual%20plates%20into%20a%20merged%20dictionary%2C%20write%20it%20to%20YAML%2C%20and%20also%20convert%20to%20a%20DataFrame.%0A%20%20%20%20If%20you%20really%20want%20to%20look%20into%20the%20details%20of%20what%20is%20being%20dropped%2C%20you%20will%20want%20to%20look%20at%20that%20merged%20YAML%20file.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(input_plate_qc_drops%2C%20mo%2C%20output_plate_qc_drops%2C%20pd%2C%20plates%2C%20yaml)%3A%0A%20%20%20%20%23%20read%20dictionary%20of%20QC%20drops%0A%20%20%20%20assert%20len(plates)%20%3D%3D%20len(input_plate_qc_drops)%0A%20%20%20%20plate_qc_drops%20%3D%20%7B%7D%0A%20%20%20%20for%20_plate%2C%20_qc_drops_yaml%20in%20zip(plates%2C%20input_plate_qc_drops)%3A%0A%20%20%20%20%20%20%20%20with%20open(_qc_drops_yaml)%20as%20_f%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20plate_qc_drops%5B_plate%5D%20%3D%20yaml.load(_f)%0A%20%20%20%20assert%20len(plate_qc_drops)%20%3D%3D%20len(input_plate_qc_drops)%0A%0A%20%20%20%20mo.output.append(mo.md(f%22Writing%20merged%20plate%20drops%20to%20%7Boutput_plate_qc_drops%7D%22))%0A%20%20%20%20with%20open(output_plate_qc_drops%2C%20%22w%22)%20as%20_f%3A%0A%20%20%20%20%20%20%20%20yaml.dump(plate_qc_drops%2C%20stream%3D_f)%0A%0A%20%20%20%20%23%20convert%20dictionary%20of%20QC%20drops%20into%20list%20of%20tuples%0A%20%20%20%20plate_qc_drop_tups%20%3D%20%5B%0A%20%20%20%20%20%20%20%20(plate_key%2C%20droptype_key%2C%20drop_key%2C%20reason)%0A%20%20%20%20%20%20%20%20for%20plate_key%2C%20plate_val%20in%20plate_qc_drops.items()%0A%20%20%20%20%20%20%20%20for%20droptype_key%2C%20droptype_val%20in%20plate_val.items()%0A%20%20%20%20%20%20%20%20for%20drop_key%2C%20reason%20in%20droptype_val.items()%0A%20%20%20%20%5D%0A%0A%20%20%20%20%23%20create%20data%20frame%20of%20QC%20drops%0A%20%20%20%20plate_qc_drops_df%20%3D%20pd.DataFrame(%0A%20%20%20%20%20%20%20%20plate_qc_drop_tups%2C%20columns%3D%5B%22plate%22%2C%20%22drop%20type%22%2C%20%22drop%22%2C%20%22reason%22%5D%0A%20%20%20%20)%0A%20%20%20%20return%20plate_qc_drops%2C%20plate_qc_drops_df%0A%0A%0A%40app.cell%0Adef%20_(pd%2C%20plate_qc_drops_df)%3A%0A%20%20%20%20plate_qc_drop_counts%20%3D%20plate_qc_drops_df.groupby(%0A%20%20%20%20%20%20%20%20%5B%22plate%22%2C%20%22drop%20type%22%2C%20%22reason%22%5D%2C%20as_index%3DFalse%0A%20%20%20%20).aggregate(n_drops%3Dpd.NamedAgg(%22drop%22%2C%20%22nunique%22))%0A%20%20%20%20assert%20plate_qc_drop_counts%5B%22n_drops%22%5D.sum()%20%3D%3D%20len(plate_qc_drops_df)%0A%20%20%20%20return%20(plate_qc_drop_counts%2C)%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20Now%20plot%20the%20number%20of%20drops%20for%20each%20plate.%0A%20%20%20%20You%20should%20be%20worried%20(maybe%20re-do%20or%20discard)%20any%20plates%20with%20a%20very%20large%20number%20of%20drops%3A%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(alt%2C%20plate_qc_drop_counts%2C%20plates)%3A%0A%20%20%20%20plate_selection%20%3D%20alt.selection_point(fields%3D%5B%22plate%22%5D%2C%20on%3D%22mouseover%22%2C%20empty%3DFalse)%0A%0A%20%20%20%20plate_qc_drop_counts_chart%20%3D%20(%0A%20%20%20%20%20%20%20%20alt.Chart(plate_qc_drop_counts)%0A%20%20%20%20%20%20%20%20.add_params(plate_selection)%0A%20%20%20%20%20%20%20%20.encode(%0A%20%20%20%20%20%20%20%20%20%20%20%20alt.X(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22n_drops%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20title%3D%22number%20of%20drops%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20alt.Y(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22plate%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20sort%3Dplates%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20title%3DNone%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20axis%3Dalt.Axis(labelFontStyle%3D%22bold%22%2C%20labelFontSize%3D11)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20alt.Column(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22drop%20type%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20title%3DNone%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20spacing%3D5%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20header%3Dalt.Header(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20labelFontSize%3D12%2C%20labelFontStyle%3D%22bold%22%2C%20labelPadding%3D1%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20alt.Color(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22reason%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20legend%3Dalt.Legend(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20orient%3D%22top%22%2C%20columns%3D1%2C%20labelLimit%3D230%2C%20title%3DNone%2C%20padding%3D1%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20strokeWidth%3Dalt.condition(plate_selection%2C%20alt.value(3)%2C%20alt.value(0.5))%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20tooltip%3Dplate_qc_drop_counts.columns.tolist()%2C%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20.mark_bar(height%3D%7B%22band%22%3A%200.8%7D%2C%20stroke%3D%22black%22)%0A%20%20%20%20%20%20%20%20.properties(%0A%20%20%20%20%20%20%20%20%20%20%20%20width%3D230%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20height%3Dalt.Step(16)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20title%3Dalt.TitleParams(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22Number%20of%20QC%20drops%20when%20processing%20plates%22%2C%20anchor%3D%22middle%22%2C%20dy%3D-2%0A%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20.configure_axis(grid%3DFalse)%0A%20%20%20%20%20%20%20%20.resolve_scale(color%3D%22independent%22%2C%20x%3D%22independent%22)%0A%20%20%20%20)%0A%0A%20%20%20%20plate_qc_drop_counts_chart%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%23%20Analyze%20barcode%20QC%20drops%0A%20%20%20%20If%20a%20barcode%20is%20dropped%20especially%20often%20across%20plates%2C%20that%20could%20indicate%20something%20problematic%20with%20that%20barcode%20such%20that%20it%20should%20be%20removed%20altogether%20from%20the%20library%20analysis.%0A%0A%20%20%20%20First%2C%20write%20a%20YAML%20with%20this%20information%3A%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo%2C%20output_barcode_qc_drops%2C%20plate_qc_drops%2C%20yaml)%3A%0A%20%20%20%20barcode_qc_drops%20%3D%20%7B%7D%0A%0A%20%20%20%20for%20_plate%2C%20plate_d%20in%20plate_qc_drops.items()%3A%0A%20%20%20%20%20%20%20%20for%20key%2C%20val%20in%20%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20tup%20for%20tup%20in%20plate_d.items()%20if%20tup%5B0%5D.startswith(%22barcode%22)%20and%20tup%5B1%5D%0A%20%20%20%20%20%20%20%20%5D%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20for%20desc%2C%20reason%20in%20val.items()%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20desc_entries%20%3D%20desc.split(None%2C%20maxsplit%3D1)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20barcode%20%3D%20desc_entries%5B0%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20len(desc_entries)%20%3D%3D%202%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20description%20%3D%20f%22%7B_plate%7D%20%7Bdesc_entries%5B1%5D%7D%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20elif%20len(desc_entries)%20%3D%3D%201%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20description%20%3D%20_plate%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20raise%20RuntimeError(%22should%20not%20get%20here%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20barcode%20not%20in%20barcode_qc_drops%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20barcode_qc_drops%5Bbarcode%5D%20%3D%20%7B%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20key%20not%20in%20barcode_qc_drops%5Bbarcode%5D%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20barcode_qc_drops%5Bbarcode%5D%5Bkey%5D%20%3D%20%7B%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20barcode_qc_drops%5Bbarcode%5D%5Bkey%5D%5Bdescription%5D%20%3D%20reason%0A%0A%20%20%20%20%23%20sort%20keys%0A%20%20%20%20def%20sort_nested(d)%3A%0A%20%20%20%20%20%20%20%20if%20isinstance(d%2C%20dict)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20dict(sorted((key%2C%20sort_nested(val))%20for%20key%2C%20val%20in%20d.items()))%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20d%0A%0A%20%20%20%20barcode_qc_drops%20%3D%20sort_nested(barcode_qc_drops)%0A%0A%20%20%20%20mo.output.append(%0A%20%20%20%20%20%20%20%20mo.md((f%22Writing%20merged%20barcode%20drops%20to%20%7Boutput_barcode_qc_drops%7D%22))%0A%20%20%20%20)%0A%20%20%20%20with%20open(output_barcode_qc_drops%2C%20%22w%22)%20as%20_f%3A%0A%20%20%20%20%20%20%20%20yaml.dump(barcode_qc_drops%2C%20stream%3D_f)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20Now%20make%20a%20plot%20showing%20how%20often%20each%20barcode%20is%20dropped%20for%20each%20reason%3A%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(pd%2C%20plate_qc_drops_df)%3A%0A%20%20%20%20barcode_drops%20%3D%20(%0A%20%20%20%20%20%20%20%20plate_qc_drops_df.query(%22%60drop%20type%60.str.startswith('barcode')%22)%0A%20%20%20%20%20%20%20%20.assign(barcode%3Dlambda%20x%3A%20x%5B%22drop%22%5D.str.split().str%5B0%5D)%0A%20%20%20%20%20%20%20%20.groupby(%5B%22drop%20type%22%2C%20%22barcode%22%5D%2C%20as_index%3DFalse)%0A%20%20%20%20%20%20%20%20.aggregate(%0A%20%20%20%20%20%20%20%20%20%20%20%20plates_where_dropped%3Dpd.NamedAgg(%22plate%22%2C%20%22nunique%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20total_drops%3Dpd.NamedAgg(%22plate%22%2C%20%22count%22)%2C%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20)%0A%20%20%20%20return%20(barcode_drops%2C)%0A%0A%0A%40app.cell%0Adef%20_(alt%2C%20barcode_drops)%3A%0A%20%20%20%20barcode_selection%20%3D%20alt.selection_point(%0A%20%20%20%20%20%20%20%20fields%3D%5B%22barcode%22%5D%2C%20on%3D%22mouseover%22%2C%20empty%3DFalse%0A%20%20%20%20)%0A%0A%20%20%20%20barcode_drops_chart%20%3D%20(%0A%20%20%20%20%20%20%20%20alt.Chart(barcode_drops)%0A%20%20%20%20%20%20%20%20.add_params(barcode_selection)%0A%20%20%20%20%20%20%20%20.encode(%0A%20%20%20%20%20%20%20%20%20%20%20%20alt.X(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22total_drops%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20title%3D%22times%20barcode%20dropped%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20alt.Y(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22barcode%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20sort%3Dalt.SortField(%22total_drops%22%2C%20order%3D%22descending%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20axis%3Dalt.Axis(labelFontSize%3D9)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20alt.Column(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22drop%20type%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20title%3DNone%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20spacing%3D8%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20header%3Dalt.Header(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20labelFontSize%3D12%2C%20labelFontStyle%3D%22bold%22%2C%20labelPadding%3D1%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20strokeWidth%3Dalt.condition(barcode_selection%2C%20alt.value(3)%2C%20alt.value(0.5))%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20tooltip%3Dbarcode_drops.columns.tolist()%2C%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20.mark_bar(height%3D%7B%22band%22%3A%200.8%7D%2C%20stroke%3D%22black%22)%0A%20%20%20%20%20%20%20%20.properties(%0A%20%20%20%20%20%20%20%20%20%20%20%20width%3D200%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20height%3Dalt.Step(10)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20title%3Dalt.TitleParams(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22Number%20of%20QC%20drops%20when%20processing%20plates%22%2C%20anchor%3D%22middle%22%2C%20dy%3D-2%0A%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20.configure_axis(grid%3DFalse)%0A%20%20%20%20%20%20%20%20.resolve_scale(color%3D%22independent%22%2C%20x%3D%22independent%22%2C%20y%3D%22independent%22)%0A%20%20%20%20)%0A%0A%20%20%20%20barcode_drops_chart%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%23%20Analyze%20the%20groups%2Fsera%20QC%0A%20%20%20%20Analyze%20the%20QC%20performed%20on%20the%20groups%2Fsera%2C%20which%20involves%20completely%20dropping%20titers%20for%20certain%20virus-sera%20pairs.%0A%0A%20%20%20%20Read%20the%20QC%20for%20different%20groups%2Fsera%20into%20a%20merged%20dictionary%2C%20write%20it%20to%20YAML%2C%20and%20also%20convert%20to%20a%20DataFrame.%0A%20%20%20%20If%20you%20really%20want%20to%20look%20into%20the%20details%20of%20what%20is%20being%20dropped%2C%20you%20will%20want%20to%20look%20at%20that%20merged%20YAML%20file.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(%0A%20%20%20%20groups_sera%2C%0A%20%20%20%20input_groups_sera_qc_drops%2C%0A%20%20%20%20mo%2C%0A%20%20%20%20output_groups_sera_qc_drops%2C%0A%20%20%20%20pd%2C%0A%20%20%20%20yaml%2C%0A)%3A%0A%20%20%20%20%23%20read%20dictionary%20of%20QC%20drops%0A%20%20%20%20assert%20len(groups_sera)%20%3D%3D%20len(input_groups_sera_qc_drops)%0A%20%20%20%20groups_sera_qc_drops%20%3D%20%7B%7D%0A%20%20%20%20for%20(group%2C%20serum)%2C%20_qc_drops_yaml%20in%20zip(groups_sera%2C%20input_groups_sera_qc_drops)%3A%0A%20%20%20%20%20%20%20%20if%20group%20not%20in%20groups_sera_qc_drops%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20groups_sera_qc_drops%5Bgroup%5D%20%3D%20%7B%7D%0A%20%20%20%20%20%20%20%20with%20open(_qc_drops_yaml)%20as%20_f%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20groups_sera_qc_drops%5Bgroup%5D%5Bserum%5D%20%3D%20yaml.load(_f)%0A%0A%20%20%20%20mo.output.append(%0A%20%20%20%20%20%20%20%20mo.md(f%22Writing%20merged%20groups%2Fsera%20drops%20to%20%7Boutput_groups_sera_qc_drops%7D%22)%0A%20%20%20%20)%0A%20%20%20%20with%20open(output_groups_sera_qc_drops%2C%20%22w%22)%20as%20_f%3A%0A%20%20%20%20%20%20%20%20yaml.dump(groups_sera_qc_drops%2C%20stream%3D_f)%0A%0A%20%20%20%20%23%20convert%20dictionary%20of%20QC%20drops%20into%20list%20of%20tuples%0A%20%20%20%20groups_sera_qc_drop_tups%20%3D%20%5B%0A%20%20%20%20%20%20%20%20(group_key%2C%20serum_key%2C%20virus%2C%20reason)%0A%20%20%20%20%20%20%20%20for%20group_key%2C%20group_val%20in%20groups_sera_qc_drops.items()%0A%20%20%20%20%20%20%20%20for%20serum_key%2C%20serum_val%20in%20group_val.items()%0A%20%20%20%20%20%20%20%20for%20virus%2C%20reason%20in%20serum_val.items()%0A%20%20%20%20%5D%0A%0A%20%20%20%20%23%20create%20data%20frame%20of%20QC%20drops%0A%20%20%20%20groups_sera_qc_drops_df%20%3D%20pd.DataFrame(%0A%20%20%20%20%20%20%20%20groups_sera_qc_drop_tups%2C%20columns%3D%5B%22group%22%2C%20%22serum%22%2C%20%22virus%22%2C%20%22reason%22%5D%0A%20%20%20%20)%0A%20%20%20%20return%20(groups_sera_qc_drops_df%2C)%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20Plot%20the%20number%20of%20viruses%20dropped%20for%20each%20group%2Fserum.%0A%20%20%20%20If%20a%20group%2Fserum%20has%20many%20missed%20viruses%2C%20then%20you%20will%20lack%20a%20lot%20of%20titers%20and%20so%20it%20may%20be%20worth%20reviewing%20the%20cause%20of%20the%20drops.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(alt%2C%20groups_sera_qc_drops_df%2C%20pd)%3A%0A%20%20%20%20groups_sera_n_drops%20%3D%20groups_sera_qc_drops_df.groupby(%0A%20%20%20%20%20%20%20%20%5B%22group%22%2C%20%22serum%22%2C%20%22reason%22%5D%2C%20as_index%3DFalse%0A%20%20%20%20).aggregate(n_viruses%3Dpd.NamedAgg(%22virus%22%2C%20%22nunique%22))%0A%20%20%20%20assert%20groups_sera_n_drops%5B%22n_viruses%22%5D.sum()%20%3D%3D%20len(groups_sera_qc_drops_df)%0A%0A%20%20%20%20groups_sera_n_drops_chart%20%3D%20(%0A%20%20%20%20%20%20%20%20alt.Chart(groups_sera_n_drops)%0A%20%20%20%20%20%20%20%20.encode(%0A%20%20%20%20%20%20%20%20%20%20%20%20alt.X(%22n_viruses%22%2C%20title%3D%22number%20of%20viruses%20dropped%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20alt.Y(%22serum%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20alt.Row(%22group%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20alt.Color(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22reason%22%2C%20title%3D%22reason%20dropped%22%2C%20legend%3Dalt.Legend(labelLimit%3D350)%0A%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20tooltip%3Dgroups_sera_n_drops.columns.tolist()%2C%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20.mark_bar(height%3D%7B%22band%22%3A%200.8%7D)%0A%20%20%20%20%20%20%20%20.properties(%0A%20%20%20%20%20%20%20%20%20%20%20%20width%3D250%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20height%3Dalt.Step(13)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20title%3D%22Number%20of%20viruses%20dropped%20at%20serum%20QC%20for%20each%20serum%22%2C%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20.configure_axis(grid%3DFalse)%0A%20%20%20%20%20%20%20%20.resolve_scale(y%3D%22independent%22%2C%20x%3D%22independent%22)%0A%20%20%20%20)%0A%0A%20%20%20%20groups_sera_n_drops_chart%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20Plot%20the%20number%20of%20sera%20for%20which%20each%20virus%20is%20dropped%20during%20serum%20QC.%0A%20%20%20%20If%20a%20virus%20is%20dropped%20for%20many%20sera%2C%20that%20may%20indicate%20some%20issue%20with%20that%20virus%20in%20assays%3A%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(alt%2C%20groups_sera_qc_drops_df%2C%20pd)%3A%0A%20%20%20%20virus_n_drops%20%3D%20groups_sera_qc_drops_df.groupby(%0A%20%20%20%20%20%20%20%20%5B%22group%22%2C%20%22virus%22%2C%20%22reason%22%5D%2C%20as_index%3DFalse%0A%20%20%20%20).aggregate(n_sera%3Dpd.NamedAgg(%22serum%22%2C%20%22nunique%22))%0A%20%20%20%20assert%20virus_n_drops%5B%22n_sera%22%5D.sum()%20%3D%3D%20len(groups_sera_qc_drops_df)%0A%0A%20%20%20%20virus_n_drops_chart%20%3D%20(%0A%20%20%20%20%20%20%20%20alt.Chart(virus_n_drops)%0A%20%20%20%20%20%20%20%20.encode(%0A%20%20%20%20%20%20%20%20%20%20%20%20alt.X(%22n_sera%22%2C%20title%3D%22number%20of%20sera%20for%20which%20virus%20is%20dropped%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20alt.Y(%22virus%22%2C%20sort%3Dalt.SortField(%22n_sera%22%2C%20order%3D%22descending%22))%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20alt.Row(%22group%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20alt.Color(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22reason%22%2C%20title%3D%22reason%20dropped%22%2C%20legend%3Dalt.Legend(labelLimit%3D350)%0A%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20tooltip%3Dvirus_n_drops.columns.tolist()%2C%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20.mark_bar(height%3D%7B%22band%22%3A%200.8%7D)%0A%20%20%20%20%20%20%20%20.properties(%0A%20%20%20%20%20%20%20%20%20%20%20%20width%3D250%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20height%3Dalt.Step(13)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20title%3D%22Number%20of%20sera%20for%20which%20each%20virus%20is%20dropped%20at%20serum%20QC%22%2C%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20.configure_axis(grid%3DFalse)%0A%20%20%20%20%20%20%20%20.resolve_scale(y%3D%22independent%22%2C%20x%3D%22independent%22)%0A%20%20%20%20)%0A%0A%20%20%20%20virus_n_drops_chart%0A%20%20%20%20return%0A%0A%0Aif%20__name__%20%3D%3D%20%22__main__%22%3A%0A%20%20%20%20app.run()%0A
</marimo-code>

<marimo-code-hash hidden="">09d250e083ded6e182dcb10bd7194c70dcd2767f9e21d0b2b86639d99559525a</marimo-code-hash>
</body>
</html>
